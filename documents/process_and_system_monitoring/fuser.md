# fuser 

Команда `fuser` (File USER) — це утиліта для ідентифікації процесів, які використовують вказані файли, директорії або сокети. Вона показує PID (ідентифікатори процесів) і може надсилати їм сигнали, наприклад, для їх завершення.

Це особливо корисно, коли ви не можете відмонтувати файлову систему, тому що вона "зайнята" (`device is busy`), або коли потрібно дізнатися, який процес блокує певний файл.

#### **Базовий синтаксис**

```bash
fuser [опції] [файл/директорія/сокет]
```

---

### **Основні опції**

| Опція | Пояснення |
| :--- | :--- |
| **`-v`**, **`--verbose`** | Включає детальний (verbose) режим. Виводить інформацію у форматі, схожому на `ps`, включаючи користувача, PID, тип доступу та команду. |
| **`-k`**, **`--kill`** | Надсилає сигнал `SIGKILL` усім процесам, що мають доступ до файлу. **Використовуйте з обережністю!** |
| **`-i`**, **`--interactive`** | Працює в парі з `-k`. Запитує підтвердження перед завершенням кожного процесу. |
| **`-u`**, **`--user`** | Показує ім'я користувача, якому належить процес. |
| **`-n пространство_імен`**, **`--namespace пространство_імен`** | Вказує простір імен. Найчастіше використовується для TCP/UDP сокетів (`-n tcp` або `-n udp`). |
| **`-m`**, **`--mount`** | Показує всі процеси, що використовують будь-які файли на вказаній файловій системі або блоковому пристрої. |
| **`-сигнал`** | Замість `SIGKILL` надсилає вказаний сигнал. Наприклад, `-HUP`, `-TERM`. |

---

### **Типи доступу**

Коли ви використовуєте `fuser`, вона може показувати літеру, що вказує на тип доступу процесу до файлу:

*   **`c`**: Поточна директорія (current directory).
*   **`e`**: Виконуваний файл (executable).
*   **`r`**: Коренева директорія (root directory).
*   **`f`**: Відкритий файл (file).
*   **`F`**: Відкритий файл для запису (file for writing).
*   **`m`**: Відображений у пам'ять файл або бібліотека (mapped file or library).

---

### **Приклади використання**

1.  **Знайти, який процес використовує файл:**
    ```bash
    fuser -v /var/log/syslog
    ```
    *Команда покаже PID та ім'я процесу, що тримає цей файл відкритим.*

2.  **Дізнатися, які процеси працюють у вашій домашній директорії:**
    ```bash
    fuser -v ~
    ```

3.  **Знайти та завершити процес, що блокує файл (з підтвердженням):**
    ```bash
    fuser -ki /path/to/locked/file
    ```
    *Це безпечніший спосіб, ніж просто `-k`, оскільки ви можете контролювати, який процес завершувати.*

4.  **Знайти, який процес слухає порт 80 (HTTP):**
    ```bash
    sudo fuser -v -n tcp 80
    ```
    *Опція `-n tcp` вказує, що ми шукаємо процеси, пов'язані з TCP-сокетом на вказаному порту.*

5.  **Примусово відмонтувати USB-накопичувач:**
    Припустимо, ви не можете відмонтувати `/mnt/usb`:
    ```bash
    # Спочатку подивимося, хто його використовує
    fuser -v -m /mnt/usb

    # Потім завершимо всі процеси, що його блокують
    sudo fuser -km /mnt/usb

    # Тепер можна безпечно відмонтувати
    sudo umount /mnt/usb
    ```
    *Опція `-m` є ключовою для роботи з точками монтування.*

6.  **Надіслати сигнал `SIGHUP` процесу, що використовує файл конфігурації:**
    Це може бути корисно для перезавантаження конфігурації сервісу без його повного перезапуску.
    ```bash
    sudo fuser -k -HUP /etc/nginx/nginx.conf
    ```
