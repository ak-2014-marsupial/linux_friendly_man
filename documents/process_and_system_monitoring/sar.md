Утиліта `sar` (System Activity Reporter) — це потужний інструмент для моніторингу продуктивності системи в Linux. Вона входить до пакету `sysstat` і дозволяє збирати та аналізувати дані про використання CPU, пам'яті, дискового вводу-виводу, мережевої активності та багато іншого. `sar` може показувати як дані в реальному часі, так і історичні дані, зібрані у фоновому режимі.

#### **Встановлення**

`sar` є частиною пакету `sysstat`. Щоб встановити його, виконайте:

*   **Debian/Ubuntu:**
    ```bash
    sudo apt update
    sudo apt install sysstat
    ```
*   **CentOS/RHEL/Fedora:**
    ```bash
    sudo yum install sysstat # для CentOS/RHEL
    sudo dnf install sysstat # для Fedora
    ```

Після встановлення потрібно активувати збір статистики:
```bash
sudo systemctl enable sysstat
sudo systemctl start sysstat
```
За замовчуванням, дані збираються кожні 10 хвилин і зберігаються в директорії `/var/log/sa/` у файлах `saDD`, де `DD` — день місяця.

#### **Базовий синтаксис**

```bash
sar [опції] [інтервал] [кількість]
```

*   **`[опції]`**: Ключі, що визначають, яку інформацію показувати (наприклад, `-u` для CPU, `-r` для пам'яті).
*   **`[інтервал]`**: Час в секундах між зборами даних.
*   **`[кількість]`**: Скільки разів збирати дані.

Якщо `інтервал` та `кількість` не вказані, `sar` показує статистику за поточний день.

---

### **Основні ключі для моніторингу**

*   **`-u` — Використання CPU**
    Показує статистику по завантаженню процесора.
    *   `%user`: відсоток часу CPU, витрачений на процеси користувача.
    *   `%system`: відсоток часу CPU, витрачений на ядро.
    *   `%iowait`: відсоток часу, який CPU про простоював в очікуванні завершення операцій вводу-виводу.
    *   `%idle`: відсоток часу, який CPU був у простої.

*   **`-P ALL` — Використання кожного ядра CPU**
    Показує статистику для кожного процесорного ядра окремо.

*   **`-r` — Використання пам'яті**
    Надає інформацію про використання оперативної пам'яті (RAM).
    *   `kbmemfree`: вільна пам'ять в кілобайтах.
    *   `kbmemused`: використана пам'ять в кілобайтах.
    *   `%memused`: відсоток використаної пам'яті.
    *   `kbbuffers`, `kbcached`: пам'ять, що використовується буферами та кешем.

*   **`-S` — Використання файлу підкачки (swap)**
    Показує статистику по використанню swap-простору.

*   **`-b` — Активність вводу-виводу (I/O)**
    Статистика дискових операцій.
    *   `tps`: загальна кількість передач в секунду.
    *   `rtps`, `wtps`: кількість операцій читання та запису в секунду.
    *   `bread/s`, `bwrtn/s`: кількість блоків, прочитаних та записаних в секунду.

*   **`-d` — Активність по кожному блоковому пристрою**
    Детальна статистика вводу-виводу для кожного диска окремо.

*   **`-n DEV` — Мережева статистика**
    Показує статистику по мережевих інтерфейсах.
    *   `rxpck/s`, `txpck/s`: кількість отриманих та відправлених пакетів в секунду.
    *   `rxkB/s`, `txkB/s`: кількість отриманих та відправлених кілобайт в секунду.

*   **`-q` — Черга запуску та середнє навантаження (Load Average)**
    *   `runq-sz`: довжина черги процесів, готових до виконання.
    *   `ldavg-1`, `ldavg-5`, `ldavg-15`: середнє навантаження на систему за 1, 5, та 15 хвилин.

---
### **Приклади використання**

1.  **Показати статистику CPU за поточний день:**
    ```bash
    sar -u
    ```

2.  **Моніторити завантаження CPU в реальному часі (кожні 2 секунди, 5 разів):**
    ```bash
    sar -u 2 5
    ```

3.  **Показати статистику по кожному ядру CPU (1 раз з інтервалом 1 секунда):**
    ```bash
    sar -P ALL 1 1
    ```

4.  **Переглянути використання пам'яті:**
    ```bash
    sar -r
    ```

5.  **Показати статистику дискового I/O:**
    ```bash
    sar -b
    ```

6.  **Моніторити активність мережевого інтерфейсу `eth0`:**
    ```bash
    sar -n DEV | grep eth0
    ```

7.  **Показати середнє навантаження на систему:**
    ```bash
    sar -q
    ```

### **Робота з історичними даними**

`sar` дозволяє аналізувати дані, зібрані в попередні дні.

*   **Показати статистику CPU за вчорашній день:**
    ```bash
    sar -u -f /var/log/sa/sa$(date +%d -d "yesterday")
    ```
    Або простіше:
    ```bash
    sar -u -1
    ```

*   **Показати статистику пам'яті за 15-е число поточного місяця:**
    ```bash
    sar -r -f /var/log/sa/sa15
    ```
