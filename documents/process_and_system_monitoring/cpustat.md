Команда `cpustat` (CPU statistics) — це утиліта для моніторингу використання центрального процесора (CPU) окремими процесами. На відміну від `top` або `htop`, які показують загальне навантаження, `cpustat` дозволяє детально аналізувати, як конкретні програми використовують ресурси CPU.

`cpustat` часто не входить до стандартного набору утиліт і може потребувати окремого встановлення.

#### **Базовий синтаксис**

```bash
sudo cpustat [опції] [інтервал]
```
*Команда зазвичай вимагає прав `sudo` для доступу до системної статистики.*

---

### **Основні опції та їх комбінації**

| Опція/Комбінація | Пояснення |
| :--- | :--- |
| **`cpustat`** | Запустити моніторинг і показувати статистику для всіх активних процесів. |
| **`cpustat 1`** | Оновлювати дані кожну секунду. |
| **`cpustat -p PID`** | Моніторити лише процес із вказаним ідентифікатором (PID). |
| **`cpustat -a`** | Розраховувати використання CPU на основі всіх ядер системи (агреговано). |
| **`-n N`** | Показати топ `N` процесів за навантаженням на CPU. |
| **`-r csv_файл`** | Вивести зібрані дані у CSV-файл для подальшого аналізу. |
| **`-i <секунди>`** | Встановити інтервал оновлення в секундах. |

---

### **Розшифровка виводу**

Вивід `cpustat` зазвичай містить такі стовпці:

*   **`PID`**: Ідентифікатор процесу.
*   **`NAME`**: Ім'я процесу.
*   **`%CPU`**: Відсоток використання CPU процесом.
*   **`%USR`**: Відсоток часу, проведеного в режимі користувача.
*   **`%SYS`**: Відсоток часу, проведеного в режимі ядра.
*   **`%WAIT`**: Відсоток часу, витраченого на очікування операцій вводу/виводу (I/O).
*   **`SWITCH`**: Кількість перемикань контексту.
*   **`RSS`**: Реальний розмір пам'яті, зайнятий процесом.

---

### **Приклади використання**

1.  **Запустити базовий моніторинг з оновленням кожні 2 секунди:**
    ```bash
    sudo cpustat 2
    ```

2.  **Знайти процес, який найбільше навантажує CPU:**
    Запустіть `cpustat` і подивіться на процеси нагорі списку, відсортованого за `%CPU`.

3.  **Моніторити конкретний процес (наприклад, з PID 1234):**
    ```bash
    sudo cpustat -p 1234
    ```

4.  **Показати 10 найбільш "ненажерливих" процесів:**
    ```bash
    sudo cpustat -n 10
    ```

5.  **Зберегти статистику в файл для аналізу:**
    Ця команда буде збирати дані протягом 10 секунд (5 разів по 2 секунди) і зберігати їх.
    ```bash
    sudo cpustat -i 2 -r stats.csv 5
    ```

---

### **Встановлення**

Якщо команда `cpustat` відсутня у вашій системі, її можна встановити за допомогою менеджера пакунків або з вихідних кодів.

**Debian/Ubuntu:**
```bash
sudo apt-get install cpustat
```

**Fedora/CentOS:**
```bash
sudo dnf install cpustat
```

**З вихідних кодів (потрібен Go):**
```bash
go get github.com/uber-common/cpustat
```
---