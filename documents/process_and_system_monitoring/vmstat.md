# vmstat

Утиліта `vmstat` (Virtual Memory Statistics) — це інструмент моніторингу, який надає інформацію про процеси, пам'ять, підкачку (swap), ввід/вивід (I/O), системні переривання та активність центрального процесора (CPU).

[=> Детальний розбір полів vmstat та їх значень](./vmstat_fields.md)

#### **Базовий синтаксис**

```bash
vmstat [опції] [затримка] [кількість]
```

*   **`[опції]`**: Ключі, що змінюють поведінку або формат виводу.
*   **`[затримка]`**: Інтервал часу в секундах між оновленнями даних.
*   **`[кількість]`**: Кількість оновлень, після яких команда завершить роботу. Якщо `кількість` не вказано, команда працюватиме нескінченно.

---

### **Опис полів виводу**

Вивід `vmstat` складається з кількох колонок, згрупованих за категоріями.

| Категорія | Поле | Опис |
| :--- | :--- | :--- |
| **`procs`** | **`r`** | Кількість процесів, що очікують на виконання (run queue). |
| | **`b`** | Кількість процесів у стані безперервного сну (заблоковані, очікують на I/O). |
| **`memory`**| **`swpd`** | Обсяг використаної віртуальної пам'яті (swap). |
| | **`free`** | Обсяг вільної оперативної пам'яті. |
| | **`buff`** | Обсяг пам'яті, що використовується як буфери. |
| | **`cache`**| Обсяг пам'яті, що використовується як кеш. |
| **`swap`** | **`si`** | Обсяг пам'яті, завантаженої з диска (swap-in) за секунду. |
| | **`so`** | Обсяг пам'яті, вивантаженої на диск (swap-out) за секунду. |
| **`io`** | **`bi`** | Кількість блоків, отриманих з блочного пристрою (blocks in) за секунду. |
| | **`bo`** | Кількість блоків, відправлених на блочний пристрій (blocks out) за секунду. |
| **`system`**| **`in`** | Кількість переривань (interrupts) за секунду. |
| | **`cs`** | Кількість перемикань контексту (context switches) за секунду. |
| **`cpu`** | **`us`** | Час CPU, витрачений на виконання коду користувача (user time), у %. |
| | **`sy`** | Час CPU, витрачений на виконання коду ядра (system time), у %. |
| | **`id`** | Час простою CPU (idle time), у %. |
| | **`wa`** | Час CPU, витрачений на очікування завершення операцій вводу/виводу (wait I/O), у %. |
| | **`st`** | Час, "вкрадений" у віртуальної машини гіпервізором (stolen time), у %. |

---

### **Основні ключі (опції)**

| Ключ | Пояснення |
| :--- | :--- |
| **`-a`** | (`--active`) Показує активну та неактивну пам'ять (замість `buff` та `cache`). |
| **`-f`** | (`--forks`) Показує кількість створених процесів (forks) з моменту завантаження системи. |
| **`-s`** | (`--stats`) Виводить детальну таблицю системних подій та статистику пам'яті. |
| **`-d`** | (`--disk`) Показує статистику по дискових операціях (читання/запис). |
| **`-p розділ`** | (`--partition розділ`) Показує детальну статистику для вказаного дискового розділу. |
| **`-S [k,K,m,M]`** | (`--unit`) Вказує одиниці виміру для виводу: `k` (1000), `K` (1024), `m` (1000000), `M` (1048576) байт. |
| **`-w`** | (`--wide`) Забезпечує ширший вивід, щоб уникнути обрізання колонок на широких екранах. |
| **`-t`** | (`--timestamp`) Додає часову мітку до кожного рядка виводу. |

---

### **Приклади використання**

1.  **Отримати звіт про поточний стан системи:**
    *Перший рядок виводу показує середні значення з моменту завантаження системи.*
    ```bash
    vmstat
    ```

2.  **Моніторити систему кожні 2 секунди:**
    *Команда буде оновлювати дані кожні 2 секунди нескінченно. Зупинити можна за допомогою `Ctrl+C`.*
    ```bash
    vmstat 2
    ```

3.  **Отримати 5 звітів з інтервалом в 2 секунди:**
    ```bash
    vmstat 2 5
    ```

4.  **Відобразити статистику в мегабайтах (MB):**
    ```bash
    vmstat -S M
    ```

5.  **Показати детальну статистику по дисках:**
    ```bash
    vmstat -d
    ```

6.  **Показати зведену статистику пам'яті та системних подій:**
    ```bash
    vmstat -s
    ```

7.  **Показати активну та неактивну пам'ять з оновленням кожні 3 секунди:**
    ```bash
    vmstat -a 3
    ```

8.  **Моніторити статистику для конкретного розділу, наприклад, `sda1`:**
    ```bash
    vmstat -p /dev/sda1
    ```

9.  **Вивести статистику з часовими мітками:**
    ```bash
    vmstat -t 2 5
    ```
