# Посібник з утиліти `sort`

`sort` — це стандартна утиліта командного рядка в Unix-подібних системах, призначена для сортування рядків текстових файлів або потоку даних. Вона читає вхідні дані, сортує їх і виводить результат у стандартний потік виводу.

### **Ключова концепція**

За замовчуванням, `sort` сортує дані в алфавітному порядку на основі кодів символів поточної локалі. Це означає, що:
*   Сортування чутливе до регістру (великі літери йдуть перед малими: `Z` перед `a`).
*   Числа сортуються як текст (`10` йде перед `2`).

Для зміни цієї поведінки використовуються спеціальні опції.

#### **Базовий синтаксис**

```bash
# Сортування файлу
sort [опції] [файл]

# Сортування виводу іншої команди
команда | sort [опції]
```

---

### **Основні опції**

#### **Загальне керування сортуванням**

| Опція | Пояснення |
| :--- | :--- |
| **`-r`** | **(Reverse)**. Сортувати у зворотному (зворотному) порядку. |
| **`-f`** | **(Fold case / Ignore case)**. Ігнорувати регістр символів при сортуванні. |
| **`-u`** | **(Unique)**. Виводити лише унікальні рядки. Якщо кілька рядків однакові, буде показано лише перший з них. |
| **`-o [файл]`** | **(Output)**. Записати результат у вказаний файл замість стандартного виводу. Це правильний спосіб сортувати файл "на місці". |

#### **Сортування за числовими значеннями**

| Опція | Пояснення |
| :--- | :--- |
| **`-n`** | **(Numeric sort)**. Сортувати за числовим значенням. `10` буде після `2`. |
| **`-h`** | **(Human-numeric sort)**. Сортувати за числовими значеннями, які є "людино-читабельними" (наприклад, `2K`, `1M`, `1G`). Дуже корисно для сортування виводу команд `ls -lh` або `du -h`. |

#### **Сортування за колонками (ключами)**

Це найпотужніша можливість `sort`.

| Опція | Пояснення |
| :--- | :--- |
| **`-k [ключ]`** | **(Key)**. Вказати поле (колонку) для сортування. Поля нумеруються з 1. |
| **`-t [символ]`** | **(Field separator)**. Вказати символ-розділювач полів. За замовчуванням — пробіл або табуляція. |

**Синтаксис ключа (`-k`):**
*   `-k 2`: сортувати за другою колонкою.
*   `-k 2n`: сортувати за другою колонкою як за числом.
*   `-k 2,2`: сортувати лише за другою колонкою (не враховувати наступні як частину ключа).
*   `-k 2,2 -k 1,1`: сортувати за другою колонкою, а рядки з однаковими другими колонками — за першою.

#### **Інші корисні опції**

| Опція | Пояснення |
| :--- | :--- |
| **`-c`** | **(Check)**. Перевірити, чи файл вже відсортовано. Якщо так, команда нічого не виводить. Якщо ні — повідомляє про помилку. |
| **`-R`** | **(Random sort)**. Перемішати рядки у випадковому порядку. |

---

### **Практичні приклади**

Припустимо, є файл `grades.txt`:
```
Alice 95 A
Bob 82 B
Charlie 100 A
David 82 C
```

1.  **Просте алфавітне сортування (за іменем):**
    ```bash
    sort grades.txt
    ```

2.  **Сортування у зворотному алфавітному порядку:**
    ```bash
    sort -r grades.txt
    ```

3.  **Сортування за другою колонкою (оцінка) як за числом:**
    ```bash
    sort -k 2n grades.txt
    ```

4.  **Сортування за третьою колонкою, а потім за першою:**
    ```bash
    sort -k 3,3 -k 1,1 grades.txt
    ```

5.  **Сортування файлу `/etc/passwd` за ID користувача (третє поле, числове):**
    ```bash
    sort -t ':' -k 3n /etc/passwd
    ```

6.  **Показати розміри файлів у поточній директорії, відсортовані за розміром:**
    ```bash
    du -sh * | sort -h
    ```

7.  **Вивести список унікальних імен користувачів, які увійшли в систему:**
    ```bash
    who | awk '{print $1}' | sort -u
    ```

8.  **Зберегти відсортований файл:**
    *   **Неправильно (файл буде порожнім!):** `sort grades.txt > grades.txt`
    *   **Правильно (з опцією `-o`):**
        ```bash
        sort -o grades.txt grades.txt
        ```
    *   **Правильно (з тимчасовим файлом):**
        ```bash
        sort grades.txt > sorted_grades.txt && mv sorted_grades.txt grades.txt
        ```

### **`sort -u` та `uniq`**

Команда `sort -u` є еквівалентом `sort | uniq`. Однак утиліта `uniq` має додаткові можливості, наприклад, підрахунок дублікатів (`-c`). `uniq` вимагає, щоб дані були попередньо відсортовані.

**Класичний приклад: порахувати кількість входжень кожного рядка:**
```bash
sort access.log | uniq -c
```
