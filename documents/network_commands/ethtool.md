Команда `ethtool` (Ethernet tool) — це потужна утиліта для перегляду та зміни параметрів мережевих карт (NIC). Вона дозволяє керувати такими налаштуваннями, як швидкість, дуплекс, автоузгодження, а також переглядати статистику драйвера та апаратного забезпечення.

Для зміни налаштувань потрібні права суперкористувача (`sudo`).

#### **Базовий синтаксис**

```bash
ethtool [опції] <назва_інтерфейсу>
```
*Назва інтерфейсу — це, наприклад, `eth0`, `enp3s0` тощо.*

---

### **Основні опції та їх комбінації**

| Опція/Комбінація | Пояснення |
| :--- | :--- |
| **`ethtool <інтерфейс>`** | Показати поточні налаштування мережевої карти: швидкість, дуплекс, статус з'єднання. |
| **`-i` або `--driver`** | Вивести інформацію про драйвер, що використовується для даного інтерфейсу. |
| **`-S` або `--statistics`** | Показати детальну статистику мережевого інтерфейсу (кількість переданих/отриманих пакетів, помилки тощо). |
| **`-p` або `--identify`** | Запустити візуальну ідентифікацію інтерфейсу (зазвичай, змушує блимати світлодіод на порті). Дуже корисно, якщо у вас кілька портів. |
| **`-s` або `--change`** | Змінити налаштування інтерфейсу. Використовується разом з параметрами, такими як `speed`, `duplex`, `autoneg`. |
| **`--show-features`** | Показати апаратні та програмні можливості інтерфейсу (наприклад, `tcp-segmentation-offload`). |
| **`--change-features`** | Увімкнути або вимкнути певні можливості. |

---

### **Розшифровка виводу `ethtool`**

Приклад виводу `ethtool eth0`:
```
Settings for eth0:
        Supported ports: [ TP ]
        Supported link modes:   10baseT/Half 10baseT/Full
                                100baseT/Half 100baseT/Full
                                1000baseT/Full
        Speed: 1000Mb/s
        Duplex: Full
        Port: Twisted Pair
        Auto-negotiation: on
        Link detected: yes
```

*   **`Supported link modes`**: Режими роботи, які підтримує карта.
*   **`Speed`**: Поточна швидкість з'єднання.
*   **`Duplex`**: Поточний режим дуплексу (Full — повнодуплексний, Half — напівдуплексний).
*   **`Auto-negotiation`**: Чи ввімкнено автоматичне узгодження параметрів з'єднання.
*   **`Link detected`**: Чи є фізичне з'єднання (чи підключений кабель).

---

### **Приклади використання**

1.  **Перевірити статус з'єднання `enp3s0`:**
    ```bash
    ethtool enp3s0
    ```

2.  **Дізнатися, який драйвер використовує ваша мережева карта:**
    ```bash
    ethtool -i enp3s0
    ```

3.  **Переглянути детальну статистику помилок та трафіку:**
    ```bash
    ethtool -S enp3s0
    ```

4.  **Змусити світлодіод на порті блимати протягом 10 секунд для ідентифікації:**
    ```bash
    sudo ethtool -p enp3s0 10
    ```

5.  **Примусово встановити швидкість 100 Мбіт/с та повний дуплекс:**
    *Спочатку потрібно вимкнути автоузгодження.*
    ```bash
    sudo ethtool -s enp3s0 autoneg off speed 100 duplex full
    ```
    *Увага: Неправильні налаштування можуть призвести до втрати мережевого з'єднання.*

6.  **Увімкнути автоузгодження (рекомендовано):**
    ```bash
    sudo ethtool -s enp3s0 autoneg on
    ```

---

### **Продвинуті приклади**

1.  **Перевірка можливостей розвантаження (offloading):**
    Це дозволяє перенести частину обробки трафіку з CPU на мережеву карту.
    ```bash
    ethtool -k enp3s0
    # або --show-features
    ```

2.  **Вимкнути Generic Receive Offload (GRO):**
    Іноді це допомагає вирішити проблеми з продуктивністю або сумісністю.
    ```bash
    sudo ethtool -K enp3s0 gro off
    ```

3.  **Скрипт для перевірки статусу всіх мережевих інтерфейсів:**
    ```bash
    for iface in $(ls /sys/class/net); do echo "--- $iface ---"; ethtool $iface | grep "Link detected"; done
    ```
