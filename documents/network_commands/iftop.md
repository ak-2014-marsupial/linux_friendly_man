# iftop

`iftop` (Interface TOP) — це інтерактивна утиліта командного рядка, яка в реальному часі відображає список мережевих з'єднань та їхнє використання смуги пропускання на певному мережевому інтерфейсі. Це як `top` для мережевого трафіку.

**Примітка:** Для запуску `iftop` зазвичай потрібні права адміністратора (`sudo`), оскільки він потребує доступу до мережевих пакетів.

#### **Базовий синтаксис**

```bash
sudo iftop [опції]
```

---

### **Розуміння інтерфейсу**

Після запуску `iftop` виводить на екран таблицю, що постійно оновлюється.

*   **Основний екран:** Показує пари хостів, між якими відбувається обмін даними.
*   **Стрілки `=>` та `<=`**: Вказують напрямок трафіку.
*   **Колонки з трафіком:** Праворуч від пари хостів відображається швидкість передачі даних за останні 2, 10 та 40 секунд.
*   **Нижня частина екрану:**
    *   **`TX`**: сукупна швидкість передачі (Transmit).
    *   **`RX`**: сукупна швидкість прийому (Receive).
    *   **`TOTAL`**: загальна швидкість.
    *   **`cum`**: кумулятивний (загальний) обсяг трафіку з моменту запуску `iftop`.
    *   **`peak`**: пікове значення швидкості.
    *   **`rates`**: середні значення за 2, 10 та 40 секунд.

---

### **Інтерактивні команди (натискаються під час роботи)**

| Клавіша | Дія |
| :--- | :--- |
| **`h`** або **`?`** | Показати/сховати екран допомоги. |
| **`n`** | Увімкнути/вимкнути перетворення IP-адрес у хостнейми (DNS-запити). |
| **`p`** | Увімкнути/вимкнути відображення портів. |
| **`N`** | Увімкнути/вимкнути перетворення номерів портів у назви служб (напр., 80 -> http). |
| **`s`** / **`d`** | Показати/сховати інформацію про джерело (`s`) або призначення (`d`). |
| **`S`** / **`D`** | Показати/сховати порти джерела (`S`) або призначення (`D`). |
| **`t`** | Переключити режим відображення (2 рядки на з'єднання, 1 рядок, або окремо для вихідного/вхідного трафіку). |
| **`L`** | Переключити шкалу для графічного індикатора (лінійна/логарифмічна). |
| **`j`** / **`k`** | Прокрутити список з'єднань вниз/вгору. |
| **`q`** | Вийти з програми. |

---

### **Основні ключі запуску (опції)**

| Ключ | Пояснення |
| :--- | :--- |
| **`-i інтерфейс`** | Вказати мережевий інтерфейс для моніторингу (наприклад, `eth0`, `wlan0`). |
| **`-n`** | Не виконувати DNS-запити (IP-адреси не перетворюватимуться на імена хостів). Прискорює запуск. |
| **`-N`** | Не перетворювати номери портів на назви служб. |
| **`-p`** | Запустити в "нерозбірливому" (promiscuous) режимі. `iftop` буде показувати трафік між усіма хостами в мережі, а не лише той, що проходить через ваш комп'ютер. |
| **`-P`** | Показувати номери портів у списку з'єднань. |
| **`-B`** | Відображати швидкість у Байтах за секунду (за замовчуванням — у бітах). |
| **`-F мережа/маска`** | Фільтрувати трафік, показуючи лише з'єднання, що стосуються вказаної мережі (наприклад, `192.168.1.0/24`). |
| **`-f фільтр`** | Використовувати складний фільтр у форматі `pcap` (як у `tcpdump`). |

---

### **Приклади використання**

1.  **Запустити моніторинг на інтерфейсі за замовчуванням:**
    ```bash
    sudo iftop
    ```

2.  **Моніторити конкретний інтерфейс (наприклад, `wlan0`):**
    ```bash
    sudo iftop -i wlan0
    ```

3.  **Запустити без перетворення імен хостів (швидший запуск):**
    ```bash
    sudo iftop -n
    ```

4.  **Показувати номери портів та не перетворювати їх на назви служб:**
    ```bash
    sudo iftop -PN
    ```

5.  **Відображати швидкість у мегабайтах (МБ/с):**
    *Для цього потрібно поєднати ключ `-B` з інтерактивним перемиканням одиниць виміру (натискаючи `b` або `B` під час роботи).* Запуск з `-B` покаже в Байтах.
    ```bash
    sudo iftop -B
    ```

6.  **Моніторити трафік, пов'язаний з конкретним хостом:**
    ```bash
    sudo iftop -f "host 192.168.1.10"
    ```

7.  **Відстежувати лише HTTP-трафік (порт 80):**
    ```bash
    sudo iftop -f "port 80"
    ```

8.  **Моніторити весь трафік у локальній мережі (promiscuous mode):**
    ```bash
    sudo iftop -p
    ```
