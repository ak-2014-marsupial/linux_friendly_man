Команда `ss` (socket statistics) є потужним інструментом для аналізу мережевих з'єднань. Її вивід містить ключову інформацію про стан сокетів. Розглянемо найпопулярніший варіант використання: `ss -tuna`.

### 1. Розбір колонок виводу

Приклад виводу `ss -tuna`:
`tcp   ESTAB  0      0      192.168.1.10:44532    151.101.1.69:443`

| Назва | Пояснення | Потенційні наслідки (високі значення) |
| :--- | :--- | :--- |
| **Netid** | Тип сокета (`tcp`, `udp`, `u_str` для Unix-сокетів тощо). | - |
| **State** | Стан сокета. **Це найважливіша колонка для TCP.** | Див. детальний розбір станів нижче. |
| **Recv-Q** | **Receive Queue:** Кількість байт даних, отриманих від віддаленої сторони, які ще не були прочитані локальним додатком. | **Високе значення** означає, що локальний додаток не встигає обробляти вхідні дані. Це може бути ознакою перевантаження або "зависання" програми. |
| **Send-Q** | **Send Queue:** Кількість байт даних, відправлених локальним додатком, підтвердження про отримання яких ще не надійшло від віддаленої сторони. | **Високе значення** може вказувати на мережеві проблеми (поганий зв'язок, перевантаження) або на те, що віддалена система не встигає приймати дані. |
| **Local Address:Port** | Локальна IP-адреса та порт. | - |
| **Peer Address:Port** | Віддалена IP-адреса та порт. | - |

---

### 2. Стани TCP-з'єднань (TCP States)

Розуміння життєвого циклу TCP-з'єднання є ключовим для діагностики мережевих проблем.

| Стан | Пояснення | Що це означає |
| :--- | :--- | :--- |
| **`LISTEN`** | Серверний процес очікує на нові вхідні з'єднання на певному порту. | **Нормальний стан** для будь-якої мережевої служби (веб-сервер, база даних тощо). |
| **`SYN-SENT`** | Локальна сторона надіслала запит на встановлення з'єднання (пакет `SYN`) і чекає на відповідь. | **Нормальний, але короткочасний стан.** Якщо з'єднання "зависає" в цьому стані, це може вказувати на проблеми з мережею (firewall блокує) або недоступність віддаленого хоста. |
| **`SYN-RECV`** | Сервер отримав запит на з'єднання (`SYN`) і надіслав свою відповідь (`SYN-ACK`), очікуючи на фінальне підтвердження (`ACK`) від клієнта. | **Нормальний, але дуже короткочасний стан.** Велика кількість з'єднань у цьому стані може бути ознакою **SYN-flood атаки**. |
| **`ESTABLISHED`** | З'єднання встановлено, обмін даними може відбуватися в обох напрямках. | **Нормальний стан** для активного з'єднання. |
| **`FIN-WAIT-1`** | Локальна сторона ініціювала закриття з'єднання (надіслала `FIN`) і чекає на підтвердження (`ACK`) або `FIN` від віддаленої сторони. | Нормальний етап закриття з'єднання. |
| **`FIN-WAIT-2`** | Локальна сторона отримала підтвердження свого `FIN` і тепер чекає на `FIN` від віддаленої сторони. | Нормальний етап закриття. Якщо з'єднання "зависають" тут, віддалена сторона може не закривати свою частину з'єднання. |
| **`CLOSE-WAIT`** | Віддалена сторона закрила своє з'єднання (надіслала `FIN`), і система чекає, поки локальний додаток закриє свою частину. | **Велика кількість з'єднань у цьому стані — це майже завжди проблема.** Це означає, що локальний додаток не закриває з'єднання належним чином після того, як клієнт від'єднався. **Витік ресурсів.** |
| **`LAST-ACK`** | Обидві сторони ініціювали закриття, і система чекає на останнє підтвердження (`ACK`). | Останній етап перед повним закриттям. |
| **`TIME-WAIT`** | Сокет чекає певний час (зазвичай 1-2 хвилини) після закриття, щоб обробити пакети, які могли "затриматися" в мережі. | **Нормальний стан.** Однак **дуже велика кількість** з'єднань `TIME-WAIT` на навантаженому сервері може вичерпати ліміт доступних портів для нових вихідних з'єднань. |
| **`CLOSED`** | З'єднання повністю закрите. `ss` зазвичай не показує цей стан. | - |
