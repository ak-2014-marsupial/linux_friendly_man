# openssl

Утиліта `openssl` — це багатофункціональний криптографічний інструмент командного рядка. Вона використовується для широкого спектра завдань, пов'язаних із протоколами SSL/TLS, сертифікатами, шифруванням, хешуванням та іншими криптографічними операціями.

#### **Базовий синтаксис**

```bash
openssl [команда] [опції_команди] [аргументи]
```

*   **`[команда]`**: Це головна підкоманда, що визначає, яку саме функцію з набору `openssl` ви хочете використати (наприклад, `s_client`, `req`, `x509`, `enc`).

*   **`[опції_команди]`**: Це прапори (ключі), які модифікують поведінку конкретної команди. Вони зазвичай починаються з дефіса (наприклад, `-connect`, `-in`, `-out`, `-text`).

*   **`[аргументи]`**: Це значення, що передаються опціям або самій команді. На відміну від деяких інших утиліт, їхня роль сильно залежить від контексту. Це можуть бути:
    *   **Імена файлів:** Як у `openssl x509 -in certificate.pem`. Тут `certificate.pem` — аргумент опції `-in`.
    *   **Адреси серверів:** Як у `openssl s_client -connect google.com:443`. Тут `google.com:443` — аргумент опції `-connect`.
    *   **Параметри генерації:** Як у `openssl genpkey -algorithm RSA`. Тут `RSA` — аргумент опції `-algorithm`.

---

### **Основні команди `openssl`**

| Команда | Пояснення |
| :--- | :--- |
| **`s_client`** | Діє як клієнт для підключення до віддаленого сервера через SSL/TLS. Дуже корисний для діагностики. |
| **`req`** | Створення та обробка запитів на підпис сертифіката (CSR - Certificate Signing Request). |
| **`x509`** | Перегляд, конвертація та керування сертифікатами формату X.509. |
| **`genpkey`** | Генерація приватних ключів (сучасний спосіб). |
| **`rsa` / `ec`** | Керування ключами відповідних алгоритмів (старіші команди). |
| **`dgst`** | Обчислення хеш-сум (дайджестів) файлів (наприклад, SHA256, MD5). |
| **`enc`** | Шифрування та дешифрування файлів за допомогою різних шифрів (наприклад, AES). |
| **`version`** | Відображення версії `openssl` та її налаштувань. |

---
### **Приклади використання**

#### 1. Перевірка SSL-сертифіката веб-сайту
Ця команда підключається до `google.com` на порт 443 і показує повний ланцюжок сертифікатів та іншу інформацію про з'єднання.

```bash
openssl s_client -connect google.com:443
```
*   Щоб побачити лише сертифікат сервера, можна додати `-showcerts`.

#### 2. Генерація нового приватного ключа та запиту на підпис сертифіката (CSR)
Це стандартний процес для отримання SSL-сертифіката від центру сертифікації.

**Крок 1: Створити приватний ключ (наприклад, RSA 2048 біт).**
```bash
openssl genpkey -algorithm RSA -out private_key.pem -pkeyopt rsa_keygen_bits:2048
```
*   `private_key.pem` — файл, що містить ваш секретний ключ. **Зберігайте його в безпеці!**

**Крок 2: Створити CSR на основі ключа.**
```bash
openssl req -new -key private_key.pem -out my_request.csr
```
*   Утиліта поставить низку запитань (країна, організація, доменне ім'я (Common Name) тощо). Доменне ім'я є найважливішим полем.

#### 3. Створення самопідписаного сертифіката
Такий сертифікат не є довіреним для публічного використання, але ідеально підходить для розробки та тестування.

```bash
openssl req -x509 -newkey rsa:4096 -keyout private_key.pem -out certificate.pem -sha256 -days 365 -nodes
```
*   **`-x509`**: Створює сертифікат замість CSR.
*   **`-nodes`**: (No DES) — не шифрувати приватний ключ паролем. **Небезпечно для продакшену.**
*   **`-days 365`**: Термін дії сертифіката.

#### 4. Перегляд вмісту сертифіката
Дозволяє прочитати інформацію з файлу сертифіката у зрозумілому для людини форматі.

```bash
openssl x509 -in certificate.pem -text -noout
```
*   **`-in`**: Вхідний файл сертифіката.
*   **`-text`**: Показати повну інформацію.
*   **`-noout`**: Не виводити закодовану версію сертифіката.

#### 5. Обчислення хеш-суми файлу
Часто використовується для перевірки цілісності файлів.

```bash
openssl dgst -sha256 my_archive.zip
```
*Результат буде виглядати так: `SHA256(my_archive.zip)= e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855`*

#### 6. Шифрування та дешифрування файлу
`openssl` дозволяє використовувати симетричні шифри для швидкого шифрування файлів за допомогою пароля. Це відрізняється від асиметричного шифрування (де використовуються публічний/приватний ключі).

**Шифрування:**
```bash
openssl enc -aes-256-cbc -salt -in plain_text.txt -out encrypted_file.enc
```
*   Після виконання команди утиліта запитає пароль для шифрування.

**Детальний розбір команди шифрування:**
*   **`enc`**: Вказує на використання функцій шифрування.
*   **`-aes-256-cbc`**: Вибір алгоритму та режиму роботи.
    *   `aes-256`: Сам алгоритм шифрування (Advanced Encryption Standard), один із найнадійніших і найпоширеніших у світі. `256` — довжина ключа в бітах.
    *   `cbc`: Режим зчеплення блоків шифру (Cipher Block Chaining). Цей режим робить шифрування стійкішим, оскільки кожен блок даних залежить від попереднього.
*   **`-salt`**: **Дуже важлива опція.** Вона додає випадкові дані ("сіль") до вашого пароля перед тим, як згенерувати з нього ключ шифрування. Це захищає від атак за допомогою "райдужних таблиць" (pre-computed tables) і робить підбір пароля значно складнішим.
*   **`-in plain_text.txt`**: Вхідний, незашифрований файл.
*   **`-out encrypted_file.enc`**: Вихідний, зашифрований файл.

**Дешифрування:**
```bash
openssl enc -d -aes-256-cbc -in encrypted_file.enc -out decrypted_text.txt
```
*   Утиліта запитає пароль, який ви вводили при шифруванні.

**Детальний розбір команди дешифрування:**
*   **`-d`**: Ключ, що вказує на дію дешифрування (decrypt).
*   Решта параметрів (`-aes-256-cbc`, `-in`, `-out`) мають збігатися з тими, що використовувалися для шифрування. `openssl` автоматично визначить "сіль" із зашифрованого файлу.

**Примітка:** Пароль ніде не зберігається. Якщо ви його забудете, відновити дані буде неможливо. Щоб побачити повний список доступних шифрів, виконайте: `openssl enc -list`.