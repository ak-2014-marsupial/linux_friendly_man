`nmap` (Network Mapper) — це надзвичайно потужний та популярний інструмент з відкритим кодом для дослідження мереж та проведення аудитів безпеки. Він дозволяє виявляти активні хости в мережі, відкриті на них порти, операційні системи, версії служб та багато іншого.

**Увага:** Використовуйте `nmap` відповідально. Сканування мереж, які вам не належать, може вважатися незаконною діяльністю.

#### **Базовий синтаксис**

```bash
nmap [типи_сканування] [ключі] [ціль]
```

*   **`[ціль]`**: Ціль для сканування. Це може бути IP-адреса, доменне ім'я, діапазон IP (наприклад, `192.168.1.1-100`) або ціла підмережа в CIDR-нотації (наприклад, `192.168.1.0/24`).

---

### **Основні типи сканування**

*   **`-sS`** (TCP SYN Scan)
    "Напіввідкрите" сканування. Це найпопулярніший тип сканування. `nmap` надсилає SYN-пакет (як при спробі встановити з'єднання), і якщо у відповідь приходить SYN/ACK, порт вважається відкритим, а якщо RST — закритим. З'єднання ніколи не встановлюється повністю, тому цей метод менш помітний для систем логування. Вимагає прав суперкористувача.

*   **`-sT`** (TCP Connect Scan)
    Сканування через повне встановлення TCP-з'єднання. `nmap` просить ОС встановити з'єднання з цільовим портом. Цей метод надійний, але легко виявляється. Не вимагає прав суперкористувача.

*   **`-sU`** (UDP Scan)
    Сканування UDP-портів. Працює значно повільніше за TCP-сканування.

*   **`-sV`** (Version Detection)
    Визначення версій служб, що працюють на відкритих портах. Дуже корисно для пошуку застарілого та вразливого ПЗ.

*   **`-O`** (OS Detection)
    Спроба визначити операційну систему цільового хоста на основі аналізу її мережевого стека. Вимагає прав суперкористувача.

*   **`-A`** (Aggressive Scan)
    Агресивний режим, який вмикає одночасно визначення ОС (`-O`), версій служб (`-sV`), трасування (`--traceroute`) та виконання скриптів (`-sC`).

### **Важливі ключі**

*   **`-p діапазон`**: Сканувати лише вказані порти. (наприклад, `-p 22,80,443`, `-p 1-1000`, `-p-` для всіх 65535 портів).
*   **`-n`**: Не робити DNS-перетворення (прискорює сканування).
*   **`-v` / `-vv`**: Детальний / дуже детальний вивід.
*   **`-T<0-5>`**: Налаштування швидкості сканування (від `T0` - параноїдальний, до `T5` - божевільний). `-T4` є хорошою швидкою опцією.
*   **`-sn`** (Ping Scan): Просто перевірити, які хости в мережі активні, без сканування портів.

---

### **Приклади використання**

1.  **Ping-сканування для виявлення активних хостів у локальній мережі:**
    ```bash
    sudo nmap -sn 192.168.1.0/24
    ```

2.  **Базове сканування одного хоста (перші 1000 TCP-портів):**
    ```bash
    sudo nmap scanme.nmap.org
    ```

3.  **Сканування конкретних портів на хості:**
    ```bash
    sudo nmap -p 22,80,443 192.168.1.1
    ```

4.  **Швидке сканування 100 найпопулярніших портів:**
    ```bash
    sudo nmap -F 192.168.1.1
    ```

5.  **Сканування з визначенням версій служб та ОС:**
    ```bash
    sudo nmap -sV -O scanme.nmap.org
    ```

6.  **Найбільш інформативне "агресивне" сканування:**
    ```bash
    sudo nmap -A scanme.nmap.org
    ```

7.  **Сканування UDP-портів (може бути довго):**
    ```bash
    sudo nmap -sU -p 53,123,161 scanme.nmap.org
    ```

8.  **Сканування всіх TCP-портів з високою швидкістю та детальним виводом:**
    ```bash
    sudo nmap -p- -T4 -v 192.168.1.1
    ```

9.  **Сканування списку хостів із файлу:**
    ```bash
    sudo nmap -iL list_of_hosts.txt
    ```

10. **Пошук хостів у мережі, на яких відкритий порт 445 (SMB):**
    ```bash
    sudo nmap -p 445 --open 192.168.1.0/24
    ```
    *Ключ `--open` показує лише хости, де знайдено відкриті порти.*
