`nmap` (Network Mapper) — це надзвичайно потужний та популярний інструмент з відкритим кодом для дослідження мереж та проведення аудитів безпеки. Він дозволяє виявляти активні хости в мережі, відкриті на них порти, операційні системи, версії служб та багато іншого.

**Увага:** Використовуйте `nmap` відповідально. Сканування мереж, які вам не належать, може вважатися незаконною діяльністю.

### **Базовий синтаксис**

```bash
nmap [Типи сканування] [Опції] {Ціль}
```

*   **`{Ціль}`**: Ціль для сканування. Це може бути IP-адреса, доменне ім'я, діапазон IP (наприклад, `192.168.1.1-100`) або ціла підмережа в CIDR-нотації (наприклад, `192.168.1.0/24`).

---

### **Основні опції та типи сканування**

Ключі `nmap` можна комбінувати, щоб отримати бажаний результат.

#### **1. Вибір цілі та портів**

Ці опції визначають, *що* сканувати.

*   **`-p <діапазон>`**: Сканувати лише вказані порти.
    *   `-p 22,80,443` (конкретні порти)
    *   `-p 1-1000` (діапазон)
    *   `-p-` (всі 65535 портів)
*   **`-F`** (Fast scan): Сканувати лише 100 найпопулярніших портів.
*   **`--top-ports <кількість>`**: Сканувати вказану кількість найпопулярніших портів. Більш гнучка альтернатива `-F`.
*   **`-iL <файл>`**: Сканувати цілі, вказані у файлі.
*   **`--exclude <хост1,...>`**: Виключити певні хости зі сканування.

#### **2. Типи сканування (Методи)**

Ці опції визначають, *як* сканувати.

*   **`-sS`** (TCP SYN Scan): "Напіввідкрите" сканування. Найпопулярніший тип. Надсилає SYN-пакет, і за відповіддю (SYN/ACK або RST) визначає стан порту. Не встановлює повне з'єднання, тому менш помітний. **Потребує прав суперкористувача.**
*   **`-sT`** (TCP Connect Scan): Сканування через повне встановлення TCP-з'єднання. Надійний, але легко виявляється системами моніторингу. Не потребує прав суперкористувача.
*   **`-sU`** (UDP Scan): Сканування UDP-портів. Працює значно повільніше за TCP-сканування.
*   **`-sn`** (Ping Scan): Не сканує порти, а лише перевіряє, які хости в мережі активні. Корисно для початкового дослідження мережі.

#### **3. Визначення служб та ОС**

Ці опції застосовуються до знайдених відкритих портів для отримання детальної інформації.

*   **`-sV`** (Version Detection): Визначає версії програмного забезпечення, що працюють на відкритих портах.
*   **`-O`** (OS Detection): Намагається визначити операційну систему цільового хоста. **Потребує прав суперкористувача.**
*   **`-A`** (Aggressive Scan): Агресивний режим, який є скороченням для: `-sV`, `-O`, `-sC` (виконання базових скриптів) та `--traceroute`.

#### **4. Робота зі скриптами (Nmap Scripting Engine - NSE)**

*   **`-sC`** або **`--script=default`**: Виконує набір стандартних скриптів для збору додаткової інформації. Частина агресивного сканування (`-A`), але може запускатись окремо.
*   **`--script <назва-скрипта-або-категорія>`**: Запустити конкретний скрипт або категорію (наприклад, `vuln` для пошуку вразливостей).

#### **5. Швидкість, прихованість та вивід**

*   **`-T<0-5>`**: Налаштування швидкості сканування (`T0` — найповільніший, `T4` — швидкий, `T5` — дуже агресивний).
*   **`-n`**: Не робити DNS-перетворення (прискорює сканування).
*   **`-v` / `-vv`**: Детальний / дуже детальний вивід процесу сканування.
*   **`--open`**: Показувати у звіті лише ті порти, що знаходяться у стані `open`.
*   **`--reason`**: Показувати причину, чому порт вважається відкритим, закритим або фільтрованим.
*   **`-oN <файл>`**: Зберегти результати у звичайному текстовому форматі.
*   **`-oX <файл>`**: Зберегти результати у форматі XML.

---

### **Приклади використання**

1.  **Ping-сканування для виявлення активних хостів у локальній мережі:**
    ```bash
    sudo nmap -sn 192.168.1.0/24
    ```

2.  **Базове "напіввідкрите" сканування одного хоста:**
    ```bash
    sudo nmap -sS scanme.nmap.org
    ```

3.  **Сканування діапазону портів на локальній машині:**
    ```bash
    nmap -p 31000-32000 localhost
    ```
    *Ця команда перевірить стан всіх портів від 31000 до 32000 на вашому власному комп'ютері (`localhost`).*

4.  **Швидке сканування 20 найпопулярніших портів з визначенням версій:**
    ```bash
    sudo nmap -sV --top-ports 20 192.168.1.1
    ```

5.  **Найбільш інформативне "агресивне" сканування:**
    ```bash
    sudo nmap -A scanme.nmap.org
    ```

6.  **Сканування з використанням скриптів для отримання заголовків веб-сторінок:**
    ```bash
    sudo nmap -sV --script=http-title 192.168.1.0/24
    ```

7.  **Пошук хостів у мережі з відкритим портом 445 та збереження результатів у файл:**
    ```bash
    sudo nmap -p 445 --open -v 192.168.1.0/24 -oN open_smb.txt
    ```
