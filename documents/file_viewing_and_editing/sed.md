# Посібник з утиліти `sed`

`sed` (Stream Editor) — це потужна утиліта командного рядка для обробки та трансформації тексту. `sed` читає текст рядок за рядком з файлу або стандартного вводу, застосовує до кожного рядка набір команд (скрипт) і виводить результат у стандартний вивід.

### **Ключова концепція**

`sed` працює як "неінтерактивний" текстовий редактор. Ви не відкриваєте файл у редакторі, а натомість надсилаєте йому "потік" тексту та інструкції, що з ним робити. За замовчуванням, `sed` **не змінює оригінальний файл**, а лише друкує змінений текст на екран. Щоб змінити файл, потрібна спеціальна опція.

#### **Базовий синтаксис**

```bash
sed [опції] 'команда' [файл]
команда | sed [опції] 'команда'
```

*   **`'команда'`**: Інструкція, яку `sed` має виконати. Найчастіше це команда заміни `s`.

---

### **Команда `s` (substitute) — Заміна тексту**

Це найпоширеніша і найважливіша команда `sed`. Її синтаксис:

```
s/шаблон/заміна/[прапори]
```

*   **`шаблон`**: Регулярний вираз, який потрібно знайти.
*   **`заміна`**: Текст, на який потрібно замінити знайдений шаблон.
*   **`[прапори]`** (необов'язково):
    *   **`g`** (global): Замінити **всі** входження шаблону в рядку, а не лише перше.
    *   **`i`** (ignore-case): Ігнорувати регістр при пошуку шаблону.
    *   **`N`** (число): Замінити лише N-не входження шаблону.

**Розділювач**: Замість `/` можна використовувати майже будь-який інший символ (наприклад, `#`, `|`, `_`). Це зручно, коли ви працюєте з текстом, що містить слеші (наприклад, шляхи до файлів).
`s#/path/to/old#/path/to/new#g`

### **Адресація: застосування команд до конкретних рядків**

`sed` дозволяє вказати, до яких саме рядків застосовувати команду.

*   **За номером рядка**: `sed '3d' file.txt` (видалити 3-й рядок).
*   **За діапазоном номерів**: `sed '5,10s/a/b/g' file.txt` (застосувати заміну до рядків з 5-го по 10-й).
*   **За шаблоном (регулярним виразом)**: `sed '/ERROR/d' file.txt` (видалити всі рядки, що містять `ERROR`).
*   **За діапазоном шаблонів**: `sed '/START/,/END/d' file.txt` (видалити всі рядки від того, що містить `START`, до того, що містить `END`).

### **Інші корисні команди**

| Команда | Пояснення |
| :--- | :--- |
| **`d`** | **(Delete)**. Видалити весь рядок. |
| **`p`** | **(Print)**. Надрукувати рядок. Зазвичай використовується з опцією `-n`. |
| **`i \текст`** | **(Insert)**. Вставити `текст` перед поточним рядком. |
| **`a \текст`** | **(Append)**. Додати `текст` після поточного рядка. |

### **Основні опції командного рядка**

| Опція | Пояснення |
| :--- | :--- |
| **`-i`** | **(In-place)**. **Змінити файл "на місці"**. **Обережно!** Без цієї опції `sed` лише друкує результат. Рекомендується робити резервну копію: `sed -i.bak 'команда' файл`. |
| **`-n`** | **(No print / Quiet)**. Пригнічує автоматичний друк. За замовчуванням `sed` друкує кожен рядок після обробки. З `-n` він друкуватиме лише те, що ви вкажете командою `p`. |
| **`-e`** | Дозволяє вказати кілька команд. `sed -e 'команда1' -e 'команда2' файл`. |
| **`-f [файл]`** | Виконати команди, записані у файлі скриптів. |

---

### **Практичні приклади**

1.  **Замінити перше входження `cat` на `dog` у кожному рядку:**
    ```bash
    sed 's/cat/dog/' my_file.txt
    ```

2.  **Замінити всі входження `cat` на `dog`:**
    ```bash
    sed 's/cat/dog/g' my_file.txt
    ```

3.  **Замінити шлях у файлі конфігурації (використовуючи інший розділювач):**
    ```bash
    sed 's#/var/www/html#/srv/www#g' nginx.conf
    ```

4.  **Змінити файл на місці, створивши резервну копію `config.ini.bak`:**
    ```bash
    sed -i.bak 's/enabled = false/enabled = true/g' config.ini
    ```

5.  **Видалити всі рядки, що містять `DEBUG`:**
    ```bash
    sed '/DEBUG/d' application.log
    ```

6.  **Видалити порожні рядки:**
    ```bash
    sed '/^$/d' text_file.txt
    ```

7.  **Надрукувати лише рядки з 5 по 10 (аналог `head` та `tail`):**
    ```bash
    sed -n '5,10p' large_file.txt
    ```

8.  **Закоментувати рядок, що містить `unstable_feature`:**
    ```bash
    sed '/unstable_feature/s/^/#/' config.js
    # s/^/#/ -> замінити початок рядка (^) на #
    ```

9.  **Вставити текст на початку файлу:**
    ```bash
    sed '1i # This file was automatically updated' script.sh
    ```

10. **Замінити слово "yes" на "no" лише в тих рядках, що містять "answer":**
    ```bash
    sed '/answer/s/\byes\b/no/g' data.txt
    # /answer/ -> Адреса: застосувати команду лише до рядків, що містять "answer".
    # s/\byes\b/no/g -> Команда: замінити всі окремі слова "yes" на "no".
    # \b — це "경계(boundary)", що позначає межу слова.
    ```

### **`sed` чи `awk`?**

*   **`sed`** ідеально підходить для простих, потокових операцій над рядками: **заміна, видалення, вставка**. Його синтаксис для цих завдань є більш лаконічним.
*   **`awk`** є кращим вибором, коли вам потрібно працювати з **колонками (полями)**, виконувати обчислення, використовувати змінні та писати більш складну логіку.
