# Посібник з використання утиліти `sudo`

Утиліта `sudo` (superuser do) — це ключова команда в Unix-подібних системах, яка дозволяє звичайним користувачам виконувати команди з правами іншого користувача, за замовчуванням — з правами суперкористувача (`root`).

Це основний механізм для адміністрування системи без необхідності постійно працювати під обліковим записом `root`, що значно підвищує безпеку.

#### **Базовий синтаксис**

```bash
sudo [опції] команда [аргументи_команди]
```

*   **`[опції]`**: Ключі, що змінюють поведінку `sudo`.
*   **`команда`**: Команда, яку потрібно виконати з підвищеними правами.

При першому використанні `sudo` у сесії система запитує пароль поточного користувача (не `root`). Після успішної автентифікації користувач може виконувати команди через `sudo` протягом певного часу (зазвичай 15 хвилин) без повторного введення пароля.

---

### **Основні опції (ключі)**

| Опція | Пояснення |
| :--- | :--- |
| **`-l`** | (`--list`) Показати список команд, які поточному користувачу дозволено виконувати через `sudo`. |
| **`-u [user]`** | (`--user`) Виконати команду від імені вказаного користувача, а не `root`. |
| **`-k`** | (`--reset-timestamp`) Анулювати поточну сесію `sudo`. Наступна команда `sudo` знову вимагатиме пароль. |
| **`-s`** | (`--shell`) Запустити інтерактивну оболонку (shell) з правами `root`. |
| **`-i`** | (`--login`) Запустити інтерактивну оболонку з правами `root`, але як повноцінний сеанс входу (login shell). **Це рекомендований спосіб.** |

---

### **Детально про `sudo su`**

Команда `sudo su` є дуже поширеною, але важливо розуміти, що вона робить і чому існують кращі альтернативи.

**Що таке `su`?**

`su` (substitute user) — це команда для переключення на іншого користувача. Якщо викликати її без аргументів (`su`), вона намагається переключитися на суперкористувача (`root`) і запитує **пароль користувача `root`**.

**Як працює `sudo su`?**

Ця команда є комбінацією двох інструментів:

1.  `sudo` спочатку запитує **ваш пароль**, щоб отримати тимчасові права `root`.
2.  Після успішної автентифікації `sudo` від імені `root` запускає команду `su`.
3.  `su` (вже запущена з правами `root`) переключає вас на користувача `root` без додаткового запиту пароля і запускає **нову командну оболонку**.

**Проблема з `sudo su`**

Основний недолік полягає в тому, що `sudo su` створює **нелогінову оболонку** (non-login shell). Це означає, що:

*   **Зберігається частина вашого старого середовища**: змінні оточення, такі як `$HOME`, `$USER`, `$PATH`, можуть залишитися від вашого звичайного користувача, що може призвести до несподіваної поведінки.
*   **Не завантажуються файли конфігурації `root`**: скрипти на кшталт `/root/.profile` або `/root/.bashrc`, які налаштовують середовище для `root`, не виконуються.

В результаті ви отримуєте оболонку з правами `root`, але з частково успадкованим і неповним оточенням.

### **Кращі альтернативи: `sudo -i` та `sudo -s`**

| Команда | Пояснення |
| :--- | :--- |
| **`sudo -i`** | **(Рекомендований спосіб)**. Запускає **логінову оболонку** (login shell). Це повністю імітує вхід у систему як `root`: завантажуються всі файли конфігурації (`/root/.profile`, `/root/.bashrc`), встановлюються правильні змінні середовища (`$HOME=/root`), і ви одразу опиняєтесь у домашній директорії `root` (`/root`). Це створює чисте та передбачуване середовище. |
| **`sudo -s`** | Запускає **нелогінову оболонку**, але робить це більш коректно, ніж `sudo su`. Змінна `$SHELL` використовується для запуску оболонки, і середовище стає більш схожим на `root`, хоча деякі змінні користувача можуть зберігатися. Корисна для скриптів, але для інтерактивної роботи `sudo -i` краще. |

**Висновок**: для отримання повноцінного інтерактивного сеансу `root` завжди надавайте перевагу `sudo -i`.

---

### **Приклади використання**

1.  **Оновити список пакетів у системі (типова дія адміністратора):**
    ```bash
    sudo apt update
    ```

2.  **Відредагувати системний файл, що вимагає прав `root`:**
    ```bash
    sudo nano /etc/hosts
    ```

3.  **Переглянути свої права `sudo`:**
    ```bash
    sudo -l
    ```

4.  **Перезапустити системний сервіс (наприклад, веб-сервер):**
    ```bash
    sudo systemctl restart nginx
    ```

5.  **Отримати повноцінну оболонку `root` (правильний спосіб):**
    ```bash
    sudo -i
    ```

6.  **Виконати команду від імені іншого користувача (наприклад, `www-data`):**
    ```bash
    sudo -u www-data ls -l /var/www/html
    ```

7.  **Примусово завершити сесію `sudo`, щоб наступна команда вимагала пароль:**
    ```bash
    sudo -k
    ```
