`screen` (GNU Screen) — це повноцінний віконний менеджер для терміналу, який мультиплексує фізичний термінал між кількома процесами (зазвичай, інтерактивними оболонками). Простіше кажучи, це інструмент, що дозволяє запускати кілька термінальних сесій в одному вікні та залишати їх працювати у фоновому режимі, навіть після відключення від сервера. `screen` є старішим і класичним аналогом `tmux`.

Назва походить від ідеї управління кількома віртуальними "екранами" (screens) в межах одного фізичного терміналу.

#### **Базовий синтаксис**

```bash
screen [прапори] [команда]
```

*   **`screen`** (без команди): Створює нову сесію.
*   **`screen -r`**: Підключається до останньої від'єднаної сесії.
*   **`screen -ls`**: Показує список усіх активних сесій.

---

### **Основні концепції**

*   **Сесія (Session)**: Головний контейнер, який запускається командою `screen`. Сесія продовжує існувати, доки її не буде явно завершено.
*   **Вікно (Window)**: Віртуальний термінал всередині сесії. Кожне вікно є незалежною оболонкою (shell). Ви можете перемикатися між вікнами.
*   **Регіон (Region)**: Розділена область всередині вікна. `screen` дозволяє розділяти вікно на кілька регіонів (схоже на панелі в `tmux`).

---

### **Робота з `screen`: Префікс та комбінації клавіш**

Більшість команд всередині `screen` виконуються за допомогою комбінації клавіш, яка починається з **префікса**.

**Префікс за замовчуванням: `Ctrl+a`**

Це означає, що ви спочатку натискаєте `Ctrl+a`, відпускаєте, а потім натискаєте наступну клавішу для виконання команди.

| Комбінація | Дія |
| :--- | :--- |
| **`Ctrl+a` `d`** | **D**etach (Від'єднатися) від поточної сесії. |
| **`Ctrl+a` `?`** | Показати довідку з усіма комбінаціями клавіш. |

#### **Керування вікнами**

| Комбінація | Дія |
| :--- | :--- |
| **`Ctrl+a` `c`** | **C**reate (Створити) нове вікно. |
| **`Ctrl+a` `"`** | Показати інтерактивний список вікон для перемикання. |
| **`Ctrl+a` `n`** | Переключитися на **n**ext (наступне) вікно. |
| **`Ctrl+a` `p`** | Переключитися на **p**revious (попереднє) вікно. |
| **`Ctrl+a` `0-9`** | Переключитися на вікно за його номером. |
| **`Ctrl+a` `A`** | Перейменувати поточне вікно (вводиться у рядку стану). |
| **`Ctrl+a` `k`** | **K**ill (Вбити) поточне вікно. |

#### **Керування регіонами (розділення екрану)**

| Комбінація | Дія |
| :--- | :--- |
| **`Ctrl+a` `S`** | Розділити поточний регіон **горизонтально** (Split). |
| **`Ctrl+a` `|`** | Розділити поточний регіон **вертикально**. |
| **`Ctrl+a` `(Tab)`** | Перемістити фокус на наступний регіон. |
| **`Ctrl+a` `X`** | Закрити поточний регіон. |
| **`Ctrl+a` `Q`** | Закрити всі регіони, крім поточного. |

---

### **Режим копіювання (Copy/Scrollback Mode)**

Цей режим дозволяє прокручувати історію виводу та копіювати текст.

| Комбінація | Дія |
| :--- | :--- |
| **`Ctrl+a` `[`** або **`Ctrl+a` `Esc`** | Увійти в режим копіювання/прокрутки. |
| **`PgUp` / `PgDn` / `(стрілки)`** | Навігація по тексту. |
| **`Esc`** | Вийти з режиму копіювання. |

**Процес копіювання та вставки:**
1.  Натисніть `Ctrl+a` `[` для входу в режим.
2.  Перемістіть курсор до початку тексту.
3.  Натисніть `пробіл` або `Enter`, щоб почати виділення.
4.  Перемістіть курсор до кінця потрібного фрагмента.
5.  Натисніть `пробіл` або `Enter` ще раз, щоб скопіювати текст.
6.  Натисніть `Ctrl+a` `]`, щоб вставити скопійований текст.

---

### **Приклади використання (командний рядок)**

Ці команди виконуються у вашому звичайному терміналі.

1.  **Створити нову іменовану сесію:**
    ```bash
    screen -S my_project
    ```

2.  **Показати список усіх сесій:**
    ```bash
    screen -ls
    # або
    screen -list
    ```
    *Вивід може виглядати так:*
    ```
    There are screens on:
        2345.my_project   (Detached)
        1234.another_session (Attached)
    2 Sockets in /run/screen/S-user.
    ```

3.  **Підключитися до іменованої сесії:**
    ```bash
    screen -r my_project
    # або за PID
    screen -r 2345
    ```
    *Скорочений варіант:* `screen -x my_project` (для підключення до вже підключеної сесії).

4.  **Завершити (вбити) іменовану сесію:**
    Це робиться через надсилання команди `quit` до сесії.
    ```bash
    screen -X -S my_project quit
    ```

5.  **Надіслати команду у вікно `screen`:**
    Ви можете надіслати команду у вказане вікно, не підключаючись до сесії.
    ```bash
    # Створити нове вікно з назвою 'logs' у сесії 'my_project'
    screen -S my_project -X screen -t logs
    
    # Надіслати команду 'tail -f /var/log/syslog' у вікно 'logs'
    screen -S my_project -p logs -X stuff $'tail -f /var/log/syslog
'
    ```
    *   `-p <назва_вікна>` — вказує на цільове вікно.
    *   `-X stuff <команда>` — "вставляє" текст команди у вікно. `
` симулює натискання Enter.

### **Приклад робочого процесу**

1.  **Початок роботи:** Ви підключаєтесь до сервера і створюєте сесію.
    ```bash
    ssh user@server
    screen -S monitoring
    ```

2.  **Налаштування робочого простору:**
    *   У першому вікні (номер 0) ви запускаєте `htop`.
    *   Натискаєте `Ctrl+a` `c`, щоб створити нове вікно (номер 1).
    *   У новому вікні запускаєте моніторинг логів: `tail -f /var/log/nginx/access.log`.
    *   Натискаєте `Ctrl+a` `c` ще раз (вікно 2) і залишаєте його для довільних команд.

3.  **Від'єднання:** Вам потрібно відключитися. Ви натискаєте `Ctrl+a` `d`. Всі процеси продовжують працювати.

4.  **Повернення до роботи:** Ви знову підключаєтесь до сервера і відновлюєте сесію.
    ```bash
    ssh user@server
    screen -r monitoring
    ```
    *Ваш робочий простір з усіма вікнами та запущеними процесами відновлено.*
