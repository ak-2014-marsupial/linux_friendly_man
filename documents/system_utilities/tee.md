# tee

Команда `tee` (походить від англійського "T-splitter" — Т-подібний розгалужувач, як у сантехніці) читає дані зі стандартного вводу (stdin) і одночасно записує їх у стандартний вивід (stdout) та в один або декілька файлів. Це дозволяє "розділити" потік даних.

Ви можете бачити вивід команди на екрані і одночасно зберігати його у файл.

#### **Базовий синтаксис**

```bash
команда | tee [ОПЦІЇ] [ФАЙЛ...]
```

### **Основні опції**

| Ключ | Повна назва (GNU) | Опис |
| :--- | :--- | :--- |
| `-a` | `--append` | Не перезаписувати файл, а додавати дані в кінець. |
| `-i` | `--ignore-interrupts` | Ігнорувати сигнали переривання (наприклад, `Ctrl+C`). |
| `--help` | | Показати довідкову інформацію. |
| `--version` | | Показати версію утиліти. |

---

### **Приклади використання**

1.  **Переглянути вивід та зберегти його у файл:**
    Виконаємо команду `ls -l`, побачимо результат на екрані та збережемо його у `file_list.txt`.

    ```bash
    ls -l | tee file_list.txt
    ```
    *Якщо `file_list.txt` існував, його вміст буде перезаписано.*

2.  **Додати вивід у кінець існуючого файлу:**
    Якщо потрібно не перезаписувати лог, а доповнювати його.

    ```bash
    dmesg | tee -a system_log.txt
    ```
    *Прапор `-a` (`--append`) гарантує, що нові дані будуть додані в кінець `system_log.txt`.*

3.  **Записати вивід у декілька файлів одночасно:**
    `tee` може записувати в необмежену кількість файлів.

    ```bash
    date | tee date1.txt date2.txt
    ```
    *Команда `date` виконається, її вивід з'явиться на екрані та буде записаний в обидва файли: `date1.txt` і `date2.txt`.*

4.  **Використання `tee` з `sudo` для запису у файли з обмеженим доступом:**
    Це один із найпоширеніших сценаріїв використання `tee`.

    **Проблема:**
    Спроба перенаправити вивід у системний файл за допомогою `>` завершується помилкою "Permission denied", навіть якщо команда виконана через `sudo`.
    ```bash
    # Ця команда НЕ спрацює
    sudo echo "1.2.3.4 example.com" > /etc/hosts
    ```
    *Причина в тому, що оператор перенаправлення `>` обробляється **поточною оболонкою** (наприклад, Bash) ще до того, як `sudo` підвищить привілеї для команди `echo`. Оболонка не має прав на запис у `/etc/hosts`, тому операція блокується.*

    **Рішення:**
    Команда `tee` виконується з підвищеними правами через `sudo` і отримує дані через канал (`|`).

    **Приклад 1: Додавання запису до `/etc/hosts`**
    ```bash
    echo "1.2.3.4 example.com" | sudo tee -a /etc/hosts
    ```
    *Тут `echo` виконується від імені звичайного користувача, а `tee` — від імені `root`. Прапор `-a` (`--append`) гарантує, що новий рядок буде додано в кінець файлу, а не перезапише його.*

    **Приклад 2: Створення або перезапис конфігураційного файлу**
    ```bash
    echo "net.ipv4.ip_forward=1" | sudo tee /etc/sysctl.d/99-forwarding.conf
    ```
    *Ця команда створює (або повністю перезаписує) файл конфігурації. Оскільки прапор `-a` відсутній, `tee` працює в режимі перезапису за замовчуванням.*

    **Приклад 3: Зміна параметра ядра "на льоту"**
    ```bash
    echo "1" | sudo tee /proc/sys/net/ipv4/ip_forward
    ```
    *Це дозволяє миттєво змінити налаштування ядра, записавши значення у віртуальний файл у `/proc`. Такі зміни є тимчасовими і будуть скинуті після перезавантаження системи.*

5.  **Ігнорування переривань:**
    Корисно при виконанні довготривалих операцій, щоб випадкове натискання `Ctrl+C` не зупинило запис у файл.

    ```bash
    ping example.com | tee -i ping_log.txt
    ```
    *Навіть якщо ви перервете команду `ping` за допомогою `Ctrl+C`, `tee` коректно завершить роботу і збереже дані у файл.*

6.  **Комбінування з іншими командами:**
    `tee` часто використовується в ланцюжках команд.

    ```bash
    cat /var/log/syslog | grep 'error' | tee error_log.txt | wc -l
    ```
    *Ця команда:
    1. Читає системний лог.
    2. Фільтрує рядки, що містять "error".
    3. Зберігає відфільтровані рядки у `error_log.txt`.
    4. Передає вивід далі для підрахунку кількості рядків (`wc -l`), результат якого буде виведено на екран.*
