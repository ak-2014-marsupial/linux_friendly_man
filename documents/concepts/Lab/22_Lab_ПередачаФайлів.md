# Лабораторна робота: Передача файлів

> **Мета роботи:** Навчитися використовувати стандартні утиліти командного рядка (`wget`, `scp`, `rsync`, `tar`) для завантаження, передачі та синхронізації файлів між локальною машиною та віддаленими серверами по протоколах HTTP, FTP та SSH.

---

### 1. Налаштування мережі віртуальних машин

**Завдання:** Створіть 2 віртуальні машини, на кожній із них змініть режим роботи інтерфейсу з NAT, на Bridged adapter (оберіть коректний інтерфейс реальної системи). Отримайте IP-адреси від домашнього роутера.

**Пояснення:**

Це підготовчий етап, який виконується в налаштуваннях вашого програмного забезпечення для віртуалізації (наприклад, VirtualBox або VMware).

1.  **Зміна режиму мережі:**
    *   Зайдіть у налаштування мережевого адаптера кожної віртуальної машини.
    *   Замість `NAT` оберіть `Bridged Adapter` (Мережевий міст).
    *   У полі `Name` (Ім'я) оберіть активний мережевий інтерфейс вашого комп'ютера, через який ви підключені до інтернету (наприклад, `enp0s3` для дротового з'єднання або `wlan0` для Wi-Fi).

2.  **Чому це потрібно:**
    *   **NAT (Network Address Translation):** Створює ізольовану мережу для ВМ. Ваші ВМ виходять в інтернет через вашу основну машину, але недоступні ззовні та одна для одної напряму за IP-адресою.
    *   **Bridged Adapter:** "Підключає" вашу ВМ безпосередньо до вашої локальної мережі. Ваш домашній роутер побачить ВМ як ще один повноцінний пристрій (як ваш телефон або ноутбук) і видасть їй власну IP-адресу з тієї ж підмережі (наприклад, `192.168.1.x`). Це дозволить ВМ вільно "спілкуватися" між собою та з іншими пристроями в мережі.

3.  **Отримання IP-адреси:**
    *   Після запуску ВМ з новими налаштуваннями, відкрийте термінал і виконайте команду, щоб дізнатися отриману IP-адресу:
    ```bash
    ip a
    # або
    hostname -I
    ```
    *   Запишіть IP-адреси обох машин, вони знадобляться для наступних кроків.

---

### 2. Завантаження файлу з FTP-сервера

**Завдання:** Завантажте на 1-шу ВМ файл `README` з FTP-сервера `ftp.suse.com`. Перевірте, що файл повністю завантажився.

**Рекомендована команда:**
```bash
# Використовуємо wget для простого завантаження
wget ftp://ftp.suse.com/README
```

**Пояснення:**

*   **`wget`** — це популярна утиліта для неінтерактивного завантаження файлів з мережі. Вона підтримує протоколи HTTP, HTTPS та FTP.
*   **`ftp://ftp.suse.com/README`** — це URL-адреса файлу. Ми вказуємо протокол (`ftp`), ім'я хоста (`ftp.suse.com`) та шлях до файлу (`/README`).

**Перевірка завантаження:**
1.  **Перевірка наявності та розміру:**
    ```bash
    ls -l README
    ```
    Ця команда покаже інформацію про файл, включно з його розміром. Якщо розмір не нульовий, файл, ймовірно, завантажився.
2.  **Перегляд вмісту:**
    ```bash
    less README
    # або
    cat README
    ```
    Ці команди дозволяють переглянути вміст файлу і переконатися, що він містить осмислений текст.

---

### 3. Завантаження файлів з HTTP-сервера з авторизацією

**Завдання:** Завантажте на 1-шу ВМ файли `rh7-etc` та `rh6-etc` з `guru.portaone.com:8080`. Для доступу використовуйте логін `test` та пароль `test`.

**Команди:**
```bash
# Завантаження першого файлу
wget --user=test --password=test http://guru.portaone.com:8080/rh6-etc

# Завантаження другого файлу
wget --user=test --password=test http://guru.portaone.com:8080/rh7-etc
```

**Пояснення:**

*   **`http://guru.portaone.com:8080/`** — адреса сервера, де `:8080` — це нестандартний порт (стандартний для HTTP — 80).
*   **`--user=test`** та **`--password=test`** — це прапори, які передають `wget` облікові дані (логін та пароль) для HTTP Basic Authentication. Сервер запитує ці дані перед тим, як віддати файл.

---

### 4. Перевірка завантажених архівів

**Завдання:** Перевірте, що файли `rh7-etc` та `rh6-etc` повністю завантажені.

**Команди:**
```bash
# Перевіряємо розмір та права доступу
ls -l rh*-etc

# Визначаємо тип файлів
file rh*-etc
```

**Пояснення:**

*   `ls -l` покаже, що файли мають ненульовий розмір.
*   Команда `file` є дуже корисною. Вона аналізує вміст файлу і намагається визначити його тип. Для цих файлів, ймовірно, вивід буде містити щось на зразок `gzip compressed data` або `POSIX tar archive`, що підкаже нам, що це архіви і як з ними працювати далі.

---

### 5. Розпакування архіву

**Завдання:** Розпакуйте архів `rh6-etc` в каталог `/tmp` на 1-й ВМ.

**Команда:**
```bash
# Припускаючи, що це tar-архів (можливо, стиснутий gzip)
tar -xvf rh6-etc -C /tmp
```

**Пояснення:**

*   **`tar`** — стандартна утиліта для роботи з `.tar` архівами. Вона також може автоматично працювати з архівами, стиснутими `gzip` (`.gz`) або `bzip2` (`.bz2`).
*   **Прапори:**
    *   `-x` (`--extract`): Вказує, що ми хочемо розпакувати архів.
    *   `-v` (`--verbose`): Показувати список файлів, які розпаковуються.
    *   `-f` (`--file`): Вказує, що наступний аргумент — це ім'я файлу архіву (`rh6-etc`).
    *   `-C /tmp` (`--directory /tmp`): Вказує, що розпаковувати архів потрібно не в поточний каталог, а в `/tmp`.

---

### 6. Копіювання файлу на іншу машину по SSH

**Завдання:** Завантажте файл `rh7-etc` з 1-ї ВМ на 2-гу ВМ.

**Команда (виконується на ВМ1):**
```bash
scp rh7-etc <USER_VM2>@<IP_АДРЕСА_ВМ2>:~/
```
> Замініть `<USER_VM2>` на ім'я користувача на другій ВМ, а `<IP_АДРЕСА_ВМ2>` — на її IP-адресу.

**Пояснення:**

*   **`scp` (Secure Copy)** — це утиліта для безпечного копіювання файлів між хостами по мережі. Вона використовує протокол SSH для шифрування даних та автентифікації, тому є безпечною.
*   **Синтаксис:** `scp [ЩО_КОПІЮВАТИ] [КУДИ_КОПІЮВАТИ]`
    *   `rh7-etc`: Локальний файл, який ми хочемо скопіювати.
    *   `<USER_VM2>@<IP_АДРЕСА_ВМ2>:~/`: Адреса призначення.
        *   `<USER_VM2>@<IP_АДРЕСА_ВМ2>`: Вказує, під яким користувачем і на який хост підключатися.
        *   `:`: Роздільник між хостом та шляхом на ньому.
        *   `~/`: Шлях на віддаленій машині. Символ `~` означає домашній каталог користувача `<USER_VM2>`. Файл буде скопійовано туди.

При першому підключенні `scp` запитає, чи довіряєте ви віддаленому хосту, і попросить ввести пароль для користувача `<USER_VM2>`.

---

### 7. Розпакування другого архіву

**Завдання:** Розпакуйте архів `rh7-etc` в каталог `/tmp` на 2-й ВМ.

**Команда (виконується на ВМ2):**
```bash
# Перейдіть у домашній каталог, куди скопіювали файл
cd ~/

# Розпакуйте архів
tar -xvf rh7-etc -C /tmp
```

**Пояснення:**
Дії аналогічні пункту 5, але виконуються на другій віртуальній машині.

---

### 8. Синхронізація каталогів

**Завдання:** Синхронізуйте каталог `/tmp/etc/` 1-ї ВМ з `/tmp/rh7` на 2-й ВМ таким чином, щоб були скопійовані тільки відсутні на 2-й ВМ файли.

**Команда (виконується на ВМ1):**
```bash
rsync -av /tmp/etc/ <USER_VM2>@<IP_АДРЕСА_ВМ2>:/tmp/rh7/
```

**Пояснення:**

*   **`rsync` (Remote Sync)** — потужна утиліта для синхронізації файлів та каталогів між локальними та віддаленими системами. Її головна перевага — вона передає тільки ті частини файлів, які змінилися, що робить її дуже ефективною.
*   **Прапори:**
    *   `-a` (`--archive`): Режим архівування. Це комбінація прапорів, яка зберігає права доступу, власників, часові мітки та рекурсивно копіює підкаталоги.
    *   `-v` (`--verbose`): Детальний вивід, показує, які файли копіюються.
*   **Важливість слешів:**
    *   `/tmp/etc/` (зі слешем в кінці): Означає "синхронізувати *вміст* каталогу `/tmp/etc`".
    *   `/tmp/etc` (без слеша в кінці): Означає "синхронізувати *сам каталог* `/tmp/etc`". В цьому випадку на ВМ2 був би створений каталог `/tmp/rh7/etc`.
*   **Принцип роботи:** `rsync` порівняє файли в `/tmp/etc/` на ВМ1 з файлами в `/tmp/rh7/` на ВМ2 і скопіює тільки ті, яких не вистачає на ВМ2, або ті, що новіші на ВМ1. Це точно відповідає умові завдання.
