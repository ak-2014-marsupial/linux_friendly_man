### **Завдання 1: Регулярний вираз для MAC-адрес**

> Створити регулярний вираз для валідації MAC-адрес із файлу. Файл має таку структуру:
> 
> 08:00:27:A6:2E:89

> FF-10-27-7B-DE-FE

> A00027F95C02

> A1:90:2F:99:AC:00

> ...

> Роздільник може бути, а може і ні. Якщо він є, це ":" або "-".

**Пояснення:**

MAC-адреса складається з 12 шістнадцяткових символів (0-9, a-f, A-F). Вона може бути представлена в трьох форматах:
1.  `08:00:27:A6:2E:89` (розділювач - двокрапка)
2.  `FF-10-27-7B-DE-FE` (розділювач - дефіс)
3.  `A00027F95C02` (без розділювачів)

Щоб охопити всі три випадки, можна створити комбінований регулярний вираз.

**Регулярний вираз:**

```regexp
^([0-9A-Fa-f]{2}:){5}[0-9A-Fa-f]{2}$|^([0-9A-Fa-f]{2}-){5}[0-9A-Fa-f]{2}$|^[0-9A-Fa-f]{12}$
```

**Розбір виразу:**

*   `^...$` — позначає початок і кінець рядка, щоб уникнути часткових збігів.
*   `([0-9A-Fa-f]{2}:){5}[0-9A-Fa-f]{2}` — ця частина відповідає за формат з розділювачами-двокрапками.
    *   `[0-9A-Fa-f]{2}` — будь-які два шістнадцяткові символи.
    *   `:` — розділювач-двокрапка.
    *   `(...){5}` — група з двох символів та розділювача повторюється 5 разів.
    *   `[0-9A-Fa-f]{2}` — остання група з двох символів без розділювача.
*   `|` — оператор "АБО".
*   `([0-9A-Fa-f]{2}-){5}[0-9A-Fa-f]{2}` — ця частина відповідає за формат з розділювачами-дефісами.
    *   `[0-9A-Fa-f]{2}` — будь-які два шістнадцяткові символи.
    *   `-` — розділювач-дефіс.
    *   `(...){5}` — група з двох символів та розділювача повторюється 5 разів.
    *   `[0-9A-Fa-f]{2}` — остання група з двох символів без розділювача.
*   `|` — оператор "АБО".
*   `[0-9A-Fa-f]{12}` — ця частина відповідає за формат без розділювачів (12 шістнадцяткових символів підряд).

**Приклад використання з `grep`:**

```bash
grep -E '^([0-9A-Fa-f]{2}([:-]?)){5}[0-9A-Fa-f]{2}$|^[0-9A-Fa-f]{12}$' file_with_macs.txt
```

---

### **Завдання 2: Пошук MAC-адрес в каталозі**

> Знайти усі згадки MAC-адрес в каталозі /etc (або /var) і підкаталогах.
> 
> У виводі має бути лише шлях до файлу і знайдена MAC-адреса. Уникайте потрапляння в результати пошуку фрагментів, що не є MAC-адресам.

**Рішення:**

```bash
sudo grep -rIHPio --color=auto '(?<=[^-:\w]|^)([\da-f]{2}[:-]){5}([\da-f]{2})(?=[^-:\w]|$)' /etc /var
```

**Пояснення команди та регулярного виразу:**

*   `sudo` — виконати команду з правами суперкористувача, оскільки пошук ведеться в системних каталогах `/etc` та `/var`.
*   `grep` — утиліта для пошуку тексту за шаблоном.
*   `-r` — рекурсивний пошук у вказаних каталогах та всіх їх підкаталогах.
*   `-I` — ігнорувати бінарні файли (наприклад, скомпільовані програми), що прискорює пошук і робить результат чистішим.
*   `-H` — друкувати ім'я файлу для кожного збігу (цей прапор не потрібен, оскільки `-r` його вмикає за замовчуванням, але його наявність не є помилкою).
*   `-P` — увімкнути підтримку Perl-сумісних регулярних виразів (PCRE). Це дозволяє використовувати більш потужні конструкції, такі як `\d` та lookarounds (`(?<=...)`, `(?=...)`).
*   `-i` — ігнорувати регістр символів, що дозволяє знаходити MAC-адреси, написані як `a-f`, так і `A-F`.
*   `-o` — друкувати тільки ту частину рядка, що збіглася з шаблоном (тобто, саму MAC-адресу), а не весь рядок.
*   `--color=auto` — підсвічувати знайдені збіги, що покращує читабельність виводу.

**Розбір регулярного виразу `'(?<=[^-:\w]|^)([\da-f]{2}[:-]){5}([\da-f]{2})(?=[^-:\w]|$)'`:**

Цей вираз створений для максимально точного пошуку MAC-адрес, що мають розділювачі, ігноруючи при цьому схожі послідовності, які не є MAC-адресами.

*   `(?<=[^-:\w]|^)` — **Positive Lookbehind (позитивне зазирання назад)**. Це найважливіша частина для точності. Вона перевіряє, що знаходиться *перед* потенційним збігом, але не включає це у сам збіг.
    *   `[^-:\w]` — будь-який символ, що **не є** (`^` всередині `[]`) дефісом (`-`), двокрапкою (`:`), або "символом слова" (`\w`, тобто літери, цифри та `_`). Це запобігає знаходженню MAC-адреси всередині довшої послідовності (наприклад, в `123-AB:CD:EF:12:34:56`).
    *   `|` — оператор "АБО".
    *   `^` — початок рядка.
    *   **Разом це означає:** "збіг має починатися або на початку рядка, або після символу, який не є частиною іншої потенційної MAC-адреси чи слова".

*   `([\da-f]{2}[:-]){5}` — основна частина, що описує перші 5 груп MAC-адреси.
    *   `[\da-f]{2}` — два шістнадцяткових символи. `\d` означає будь-яку цифру (еквівалент `0-9`), `a-f` — літери (регістр ігнорується через прапор `-i`).
    *   `[:-]` — розділювач: двокрапка (`:`) або дефіс (`-`).
    *   `{5}` — ця група (два символи + розділювач) повторюється рівно 5 разів.

*   `([\da-f]{2})` — остання, шоста група з двох шістнадцяткових символів без розділювача.

*   `(?=[^-:\w]|$)` — **Positive Lookahead (позитивне зазирання вперед)**. Аналогічно до lookbehind, ця конструкція перевіряє, що йде *після* збігу.
    *   `[^-:\w]` — такий самий клас символів, що й у lookbehind.
    *   `|` — "АБО".
    *   `$` — кінець рядка.
    *   **Разом це означає:** "збіг має закінчуватися або в кінці рядка, або перед символом, який не є частиною MAC-адреси чи слова".

Завдяки `lookarounds` цей вираз є набагато точнішим, ніж вирази з `\b` (межа слова), оскільки `\b` вважає `:` та `-` межами слова, що може призвести до хибних спрацьовувань.

---

### **Завдання 3: Параметри файлу /etc/nsswitch.conf**

> Виведіть усі параметри та їх значення файлу /etc/nsswitch.conf.
> 
> Вивід не має містити порожні або закоментовані рядки (починаються із #).

**Пояснення:**

Для цього завдання потрібно відфільтрувати вміст файлу, виключивши рядки, що починаються з символу `#` (коментарі) та порожні рядки.

**Команда:**

```bash
grep -vE '^\s*#|^\s*$' /etc/nsswitch.conf
```

**Розбір команди:**

*   `grep` — утиліта для пошуку.
*   `-v` — інвертувати збіг, тобто виводити рядки, які *не* відповідають шаблону.
*   `-E` — увімкнути розширені регулярні вирази.
*   `'^\s*#|^\s*$'` — шаблон для пошуку:
    *   `^\s*#` — рядок починається (`^`) з будь-якої кількості пробільних символів (`\s*`), за якими йде `#`.
    *   `|` — оператор "АБО".
    *   `^\s*$` — рядок починається (`^`), містить нуль або більше пробільних символів (`\s*`) і закінчується (`$`). Це відповідає порожнім або майже порожнім рядкам.
*   `/etc/nsswitch.conf` — файл для обробки.

---

### **Завдання 4: Пошук URL в каталозі /etc**

> Знайти всі URL виду "http(s)://..." в каталозі /etc (враховуючи і підкаталоги). Вивід має містити якомога повніший шлях або запит, наприклад:
> 
> http://httpd.apache.org/docs/2.4/mod/prefork.html
> http://proxy.yoyodyne.com:18023/
> http://bugs.centos.org/set_project.php?project_id=23&ref=http://bugs.centos.org/
> bug_report_page.php?category=yum

**Пояснення:**

Як і з MAC-адресами, ми будемо використовувати `grep` для рекурсивного пошуку. Регулярний вираз має знаходити `http://` або `https://` і всі символи, що належать до URL, доки не зустрінеться пробіл або інший розділювач.

**Команда:**

```bash
grep -rHEo 'https?://[a-zA-Z0-9./?_=&%-]+' /etc
```

**Розбір команди:**

*   `grep -rHEo` — ті ж самі прапори, що й у завданні 2.
*   `'...'` — регулярний вираз для URL:
    *   `https?` — знаходить `http` або `https` (`s` є необов'язковим).
    *   `://` — знаходить послідовність `://`.
    *   `[a-zA-Z0-9./?_=&%-]+` — знаходить один або більше (`+`) символів, які зазвичай зустрічаються в URL (літери, цифри та спеціальні символи `./?_=&%-`). Цей набір можна розширити за потреби.

---

### **Завдання 5: Пошук невдалих спроб входу**

> Знайти дату і час усіх невдалих спроб входу в систему.
> 
> Використовуйте файли /var/log/secure[-timestamp]
> 
> Якщо таких спроб не виявиться - зробіть імітацію входу під різними (навіть неіснуючими) користувачами з довільними паролями. Также враховуйте різницю в форматах віддаленого (через SSH)  і локального входу в систему.

**Пояснення:**

Інформація про спроби входу, зокрема невдалі, зазвичай зберігається у файлах `/var/log/auth.log` (Debian/Ubuntu) або `/var/log/secure` (CentOS/RHEL). Старіші логи можуть зберігатись у файлах з суфіксом дати або в архівах `.gz`.

Повідомлення про помилки можуть відрізнятися, тому потрібно шукати кілька ключових фраз, таких як `Failed password`, `authentication failure`, `FAILED LOGIN`.

**Команда:**

```bash
grep -iE 'Failed password|authentication failure|FAILED LOGIN' /var/log/secure* /var/log/auth.log*
```

**Розбір команди:**

*   `grep` — утиліта пошуку.
*   `-i` — ігнорувати регістр символів (наприклад, `failed` і `Failed`).
*   `-E` — увімкнути розширені регулярні вирази.
*   `'Failed password|authentication failure|FAILED LOGIN'` — шаблон, що шукає одну з трьох фраз.
*   `/var/log/secure* /var/log/auth.log*` — шляхи до файлів логів (використовується `*`, щоб захопити і ротовані логи, наприклад `secure-20231027`).

**Якщо спроб не виявлено (як їх імітувати):**

Якщо команда нічого не повертає, ви можете легко зімітувати невдалі спроби входу:

1.  **Через SSH (віддалений вхід):**
    *   Спробуйте підключитися до свого ж комп'ютера (localhost) з вигаданим ім'ям користувача або правильним ім'ям, але неправильним паролем.
    ```bash
    ssh some_nonexistent_user@localhost
    ```

2.  **Через `su` (локальна зміна користувача):**
    *   Спробуйте перейти в режим суперкористувача (`root`), ввівши неправильний пароль.
    ```bash
    su -
    # Введіть довільний неправильний пароль
    ```

3.  **Через екран входу (локальний вхід):**
    *   Якщо ви працюєте в графічному середовищі, вийдіть із системи та спробуйте увійти з неправильним паролем.

Після виконання цих дій повторний запуск команди `grep` повинен показати нові записи про невдалі спроби входу.
