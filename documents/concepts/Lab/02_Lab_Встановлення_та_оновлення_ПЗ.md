Звісно, ось відповіді та пояснення до лабораторної роботи по роботі з менеджерами пакунків.

### **Робота з dnf**

**1. Очистити увесь кеш dnf.**
*   **Команда:**
    ```bash
    sudo dnf clean all
    ```
*   **Пояснення:**
    *   `sudo`: виконує команду з правами суперкористувача.
    *   `dnf clean all`: ця команда видаляє всі кешовані дані, які використовує `dnf`. Це включає завантажені пакунки, метадані репозиторіїв та іншу тимчасову інформацію. Це корисно для звільнення місця або для вирішення проблем з кешем.

**2. В конфігураційному файлі dnf увімкнути зберігання завантажених пакетів в кеш.**
*   **Дія:**
    Потрібно відредагувати файл `/etc/dnf/dnf.conf`.
    1.  Відкрийте файл: `sudo nano /etc/dnf/dnf.conf`
    2.  У секції `[main]` знайдіть або додайте рядок:
        ```ini
        keepcache=true
        ```
    3.  Збережіть файл (`Ctrl+O`, `Enter`) і закрийте редактор (`Ctrl+X`).
*   **Пояснення:**
    Параметр `keepcache=true` наказує `dnf` не видаляти `.rpm` файли пакунків після їх успішного встановлення. Вони будуть зберігатися в директорії кешу (зазвичай `/var/cache/dnf/`).

**3. Спробувати встановити пакети 'nmap-ncat' і 'htop'. Перевірити успішність установки.**
*   **Команда:**
    ```bash
    sudo dnf install nmap-ncat htop
    ```
*   **Перевірка:**
    ```bash
    htop
    ncat --version
    ```
*   **Пояснення:**
    `dnf install` завантажує та встановлює вказані пакунки та їх залежності. Якщо пакунок `htop` є в стандартних репозиторіях, він встановиться. `nmap-ncat` може бути відсутнім. Перевірити можна, просто запустивши встановлені програми.

**4. Додати репозиторій EPEL.**
*   **Команда:**
    ```bash
    sudo dnf install oracle-epel-release-el9
    ```
*   **Пояснення:**
    EPEL (Extra Packages for Enterprise Linux) — це репозиторій, що надає багато додаткових якісних пакунків, яких немає у стандартних репозиторіях Enterprise Linux. Пакунок `oracle-epel-release-el9` містить файли конфігурації та GPG-ключі, які додають репозиторій EPEL до списку доступних для `dnf`.

**5. Переглянути список увімкнених та вимкнутих репозиторіїв.**
*   **Команда:**
    ```bash
    dnf repolist --all
    ```
*   **Пояснення:**
    *   `dnf repolist`: показує список увімкнених (enabled) репозиторіїв.
    *   Прапорець `--all`: додатково показує і вимкнені (disabled) репозиторії.

**6. Встановити утиліти які перед цим не встановилися та перевірити їх роботу.**
*   **Команда (приклад):**
    ```bash
    sudo dnf install nmap-ncat
    ```
*   **Пояснення:**
    Після додавання репозиторію EPEL, пакунки, які раніше були недоступні (наприклад, `nmap-ncat`), тепер можуть бути знайдені та встановлені.

**7. Визначити, до якого пакету відноситься файл ' /etc/sysctl.conf'.**
*   **Команда:**
    ```bash
    rpm -qf /etc/sysctl.conf
    ```
*   **Пояснення:**
    *   `rpm -qf` (`query file`): це стандартний спосіб дізнатися, якому **вже встановленому** пакунку належить вказаний файл. Це швидше, ніж `dnf provides`, оскільки запит іде до локальної бази даних `rpm`.

**8. Видалити пакет nmap-ncat.**
*   **Команда:**
    ```bash
    sudo dnf remove nmap-ncat
    ```
*   **Пояснення:**
    `dnf remove` видаляє вказаний пакунок, а також ті залежності, які були встановлені разом з ним і більше не потрібні іншим пакункам.

---

### **Робота з rpm**

**9. Переглянути список встановлених в системі пакетів.**
*   **Команда:**
    ```bash
    rpm -qa | less
    ```
*   **Пояснення:**
    *   `rpm -q` (`query`): запит до бази даних пакунків.
    *   `-a` (`all`): показує всі встановлені пакунки.
    *   `| less`: передає довгий вивід на програму `less` для зручного перегляду.

**10. Вивести список файлів, які відносяться до пакету htop.**
*   **Команда:**
    ```bash
    rpm -ql htop
    ```
*   **Пояснення:**
    *   `-l` (`list`): показує список файлів, що містяться у вказаному пакунку.

**11. Внести зміни в будь-який текстовий файл, який відноситься до утиліти htop, і виконати порівняння з оригінальним пакетом(verify).**
*   **Дії:**
    1.  **Знайти конфігураційний файл:** `rpm -qc htop` (покаже, наприклад, `/etc/htoprc`).
    2.  **Внести зміни:** `sudo echo "# My test comment" >> /etc/htoprc`
    3.  **Перевірити пакунок:** `rpm -V htop`
*   **Пояснення:**
    *   `rpm -V` (`--verify`): перевіряє файли встановленого пакунка на відповідність до інформації з бази даних `rpm` (розмір, права, контрольна сума тощо).
    *   Вивід може бути таким: `S.5....T. c /etc/htoprc`. Це означає, що у конфігураційного файлу (`c`) `/etc/htoprc` змінився розмір (`S`), контрольна сума MD5 (`5`) та час модифікації (`T`).

**12. Визначити до якого пакету відноситься файл '/etc/lvm/lvm.conf'.**
*   **Команда:**
    ```bash
    rpm -qf /etc/lvm/lvm.conf
    ```
*   **Пояснення:**
    Аналогічно до пункту 7, `rpm -qf` є найкращим способом для цього завдання.

**13. Знайдіть в кеші yum rpm-пакет раніше видаленої утиліти nmap-ncat, виконати його встановлення за допомогою rpm.**
*   **Дії:**
    1.  **Знайти RPM-файл в кеші:**
        ```bash
        find /var/cache/dnf/ -name "nmap-ncat*.rpm"
        ```
        (Це покаже повний шлях до файлу, наприклад, `/var/cache/dnf/epel-..../packages/nmap-ncat-....rpm`)
    2.  **Встановити за допомогою rpm:**
        ```bash
        sudo rpm -ivh /шлях/до/знайденого/файлу/nmap-ncat-....rpm
        ```
*   **Пояснення:**
    *   Оскільки ми увімкнули `keepcache=true`, завантажений `.rpm` файл залишився в кеші `dnf`.
    *   `rpm -i`: встановлює пакунок з файлу.
    *   `-v`: детальний вивід.
    *   `-h`: показує прогрес встановлення у вигляді хеш-символів (`#`).
    *   **Важливо:** `rpm` не керує залежностями. Якщо для пакунка потрібні інші пакунки, `rpm` видасть помилку. `dnf` вирішує цю проблему автоматично.

---

### **Додаткове завдання**

**14. Взяти будь-який rpm-пакет із кеша та витягнути з нього всі файли в каталог ~/rpm_files.**
*   **Команди:**
    ```bash
    mkdir ~/rpm_files
    rpm2cpio /шлях/до/пакета.rpm | cpio -idmv -D ~/rpm_files
    ```
*   **Пояснення:**
    *   `rpm2cpio`: утиліта, що конвертує `.rpm` пакунок у формат архіву `cpio` і виводить його на стандартний вивід.
    *   `|`: передає цей потік на вхід команді `cpio`.
    *   `cpio -idmv`: розпаковує архів.
        *   `-i`: режим розпакування.
        *   `-d`: створювати директорії за необхідності.
        *   `-m`: зберегти оригінальний час модифікації файлів.
        *   `-v`: детальний вивід.
    *   `-D ~/rpm_files`: вказує `cpio` розпакувати файли в цю директорію.

**15. Завантажити найсвіжішу версію утиліти nmap у вигляді вихідних файлів, скомпілювати і встановити.**
*   **Загальний процес:**
    1.  **Встановити інструменти для збірки:**
        ```bash
        sudo dnf groupinstall "Development Tools"
        sudo dnf install openssl-devel # Приклад потрібної бібліотеки
        ```
    2.  **Завантажити вихідний код** (з офіційного сайту nmap.org):
        ```bash
        wget https://nmap.org/dist/nmap-7.95.tar.bz2 
        ```
    3.  **Розпакувати архів:**
        ```bash
        tar -xvf nmap-7.95.tar.bz2
        cd nmap-7.95
        ```
    4.  **Сконфігурувати (перевірити залежності і створити Makefile):**
        ```bash
        ./configure
        ```
    5.  **Скомпілювати (зібрати програму з коду):**
        ```bash
        make
        ```
    6.  **Встановити в систему:**
        ```bash
        sudo make install
        ```
    7.  **Порівняти версії:**
        ```bash
        /usr/local/bin/nmap --version  # Скомпільована версія
        dnf info nmap                  # Версія з репозиторію
        ```
*   **Висновок:** Версія, скомпільована з вихідного коду, зазвичай є новішою, ніж версія в репозиторіях, які оновлюються не так часто.

**16. Перенаправити всі запити dnf через ssh-проксі сервер хостової системи.**
*   **Дії:**
    1.  **На гостьовій машині (вашому Linux) створіть SSH-тунель, який буде працювати як SOCKS-проксі:**
        *   Відкрийте новий термінал і виконайте (не закривайте його):
        ```bash
        ssh -D 8080 user@ip_хоста
        ```
        *   `-D 8080`: створює SOCKS-проксі на локальному порту 8080.
        *   `user@ip_хоста`: логін та IP-адреса вашої основної машини (хоста), до якої підключається віртуалка.
    2.  **Налаштуйте dnf для використання цього проксі:**
        *   Відкрийте файл `sudo nano /etc/dnf/dnf.conf`.
        *   Додайте в секцію `[main]` рядок:
        ```ini
        proxy=socks5://127.0.0.1:8080
        ```
    3.  **Перевірте, встановивши будь-який новий пакунок:**
        ```bash
        sudo dnf install cowsay
        ```
*   **Пояснення:**
    Тепер, коли `dnf` намагається з'єднатися з інтернетом, він направляє весь свій трафік на локальний порт `8080`. SSH-клієнт "слухає" цей порт, отримує трафік, шифрує його і відправляє через SSH-з'єднання на вашу хостову машину, а вже звідти — в інтернет. Це ефективний спосіб обійти мережеві обмеження або приховати трафік.