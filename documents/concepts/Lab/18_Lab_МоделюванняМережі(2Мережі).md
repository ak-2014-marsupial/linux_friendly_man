# Лабораторна робота: Моделювання мережі з двох підмереж

Нижче наведено пояснення та теоретичні відповіді до пунктів вашого завдання.

## Основне завдання

### 1. Створення моделі та призначення IP-адрес

**Завдання:** Створити модель мережі в Packet Tracer, яка складається з двох підмереж, з'єднаних маршрутизатором. Назначити IP-адреси кінцевим пристроям та шлюзу.

**Пояснення:**

1.  **Топологія:**
    *   **Підмережа 1:** Кілька ПК (напр., PC0, PC1) підключаються до комутатора (Switch0).
    *   **Підмережа 2:** Кілька ПК (напр., PC2, PC3) підключаються до іншого комутатора (Switch1).
    *   **З'єднання:** Комутатор Switch0 підключається до одного інтерфейсу маршрутизатора (Router0, напр., `GigabitEthernet0/0`), а Switch1 — до іншого (напр., `GigabitEthernet0/1`). Маршрутизатор стає центральною точкою, що з'єднує дві окремі мережі.

2.  **IP-адресація (Приклад):**
    Щоб пристрої могли спілкуватися, вони повинні мати унікальні адреси. Оскільки у нас дві *різні* підмережі, ми використовуємо два різні діапазони IP-адрес.

    *   **Підмережа 1 (напр., `192.168.1.0/24`):**
        *   Інтерфейс маршрутизатора `GigabitEthernet0/0`: `192.168.1.1` (це буде **шлюз за замовчуванням** для цієї підмережі).
        *   PC0: `192.168.1.10`
        *   PC1: `192.168.1.11`
        *   Маска підмережі для всіх: `255.255.255.0`.

    *   **Підмережа 2 (напр., `192.168.2.0/24`):**
        *   Інтерфейс маршрутизатора `GigabitEthernet0/1`: `192.168.2.1` (це буде **шлюз за замовчуванням** для цієї підмережі).
        *   PC2: `192.168.2.10`
        *   PC3: `192.168.2.11`
        *   Маска підмережі для всіх: `255.255.255.0`.

    **Важливо:** Інтерфейси маршрутизатора, до яких підключені підмережі, є "дверима" (шлюзами) для виходу з цих підмереж.

### 2. Налаштування маршруту за замовчуванням

**Завдання:** Додати на кінцеві пристрої маршрут за замовчуванням.

**Пояснення:**
Кожному кінцевому пристрою (ПК) потрібно вказати **шлюз за замовчуванням (Default Gateway)**. Це IP-адреса того інтерфейсу маршрутизатора, який знаходиться в тій самій підмережі.

*   Для PC0 та PC1 шлюзом буде `192.168.1.1`.
*   Для PC2 та PC3 шлюзом буде `192.168.2.1`.

**Чому це потрібно?** Коли ПК хоче відправити пакет, він дивиться на IP-адресу призначення.
*   Якщо адреса знаходиться в його власній підмережі, він відправляє пакет напряму через комутатор (використовуючи ARP для пошуку MAC-адреси).
*   Якщо адреса знаходиться в **іншій мережі**, ПК не знає, як туди дістатися. Тому він відправляє такий пакет на свій шлюз за замовчуванням, довіряючи маршрутизатору подальшу доставку.

### 3. Перевірка проходження пакетів

**Завдання:** В режимі симуляції перевірити проходження пакетів в межах однієї підмережі та між різними підмережами.

**Пояснення:**

*   **Обмін в межах однієї підмережі (напр., `ping` з PC0 на PC1):**
    1.  PC0 (192.168.1.10) бачить, що PC1 (192.168.1.11) знаходиться в тій самій мережі `192.168.1.0/24`.
    2.  PC0 відправляє ARP-запит: "Хто має IP 192.168.1.11, скажіть свою MAC-адресу".
    3.  PC1 відповідає своїм MAC-адресою.
    4.  PC0 відправляє ICMP-пакет (ping) напряму на MAC-адресу PC1. Пакет проходить через комутатор, **маршрутизатор у цьому процесі участі не бере**.

*   **Обмін між різними підмережами (напр., `ping` з PC0 на PC2):**
    1.  PC0 (192.168.1.10) бачить, що PC2 (192.168.2.10) знаходиться в **чужій** мережі.
    2.  PC0 розуміє, що пакет треба відправити на шлюз за замовчуванням (`192.168.1.1`).
    3.  PC0 відправляє ARP-запит, щоб знайти **MAC-адресу шлюзу** (інтерфейсу `GigabitEthernet0/0` маршрутизатора).
    4.  Отримавши MAC-адресу, PC0 відправляє пакет. В цьому пакеті:
        *   **IP-адреси (незмінні):** Source IP: `192.168.1.10`, Destination IP: `192.168.2.10`.
        *   **MAC-адреси (для першого кроку):** Source MAC: `MAC PC0`, Destination MAC: `MAC маршрутизатора`.
    5.  Маршрутизатор отримує пакет, дивиться на Destination IP (`192.168.2.10`) і за своєю таблицею маршрутизації визначає, що цей пакет треба відправити через інтерфейс `GigabitEthernet0/1` в підмережу `192.168.2.0/24`.
    6.  Маршрутизатор відправляє ARP-запит в підмережу 2, щоб знайти **MAC-адресу PC2**.
    7.  Отримавши MAC-адресу, маршрутизатор "перепаковує" IP-пакет в новий кадр і відправляє його. В цьому кадрі:
        *   **IP-адреси (ті самі):** Source IP: `192.168.1.10`, Destination IP: `192.168.2.10`.
        *   **MAC-адреси (для другого кроку):** Source MAC: `MAC маршрутизатора (з інтерфейсу G0/1)`, Destination MAC: `MAC PC2`.
    8.  PC2 отримує пакет. Зворотній шлях відбувається аналогічно.

---

## Домашнє завдання

### 1. Призначення основних полів пакету IP

IP-пакет (або дейтаграма) складається із заголовка (header) та даних (payload). Основні поля заголовка IPv4:

*   **Version (Версія):** Вказує версію протоколу (для IPv4 це `4`).
*   **IHL (Internet Header Length):** Довжина заголовка в 32-бітних словах. Мінімальне значення `5` (20 байт).
*   **Type of Service (Тип обслуговування):** Використовується для пріоритезації трафіку (QoS).
*   **Total Length (Загальна довжина):** Довжина всього пакета (заголовок + дані) в байтах.
*   **Identification, Flags, Fragment Offset:** Поля, що використовуються для фрагментації (розбиття) великих пакетів на менші частини.
*   **Time To Live (TTL, Час життя):** Лічильник, який зменшується на одиницю кожним маршрутизатором. Коли TTL досягає нуля, пакет знищується. Це запобігає "зацикленню" пакетів у мережі.
*   **Protocol (Протокол):** Вказує, якому протоколу вищого рівня належать дані (напр., `6` для TCP, `17` для UDP, `1` для ICMP).
*   **Header Checksum (Контрольна сума заголовка):** Використовується для перевірки цілісності заголовка.
*   **Source IP Address (IP-адреса відправника):** 32-бітна IP-адреса пристрою, що відправив пакет.
*   **Destination IP Address (IP-адреса отримувача):** 32-бітна IP-адреса кінцевого отримувача.

### 2. Відмінності в заголовках

#### Обмін даними в межах однієї підмережі (PC0 -> PC1)

*   **MAC-адреси:**
    *   Source MAC: MAC-адреса PC0.
    *   Destination MAC: MAC-адреса PC1.
*   **IP-адреси:**
    *   Source IP: IP-адреса PC0.
    *   Destination IP: IP-адреса PC1.
*   **TTL:** Не змінюється, оскільки пакет не проходить через маршрутизатор.

#### Обмін даними між різними мережами (PC0 -> Router0 -> PC2)

Тут ми маємо два етапи передачі на канальному рівні.

**Етап 1: PC0 -> Router0**
*   **MAC-адреси:**
    *   Source MAC: MAC-адреса PC0.
    *   Destination MAC: MAC-адреса **маршрутизатора** (його інтерфейсу в підмережі 1).
*   **IP-адреси:**
    *   Source IP: IP-адреса PC0.
    *   Destination IP: IP-адреса **PC2** (кінцевого отримувача).
*   **TTL:** Початкове значення (напр., 128).

**Етап 2: Router0 -> PC2**
*   **MAC-адреси:**
    *   Source MAC: MAC-адреса **маршрутизатора** (його інтерфейсу в підмережі 2).
    *   Destination MAC: MAC-адреса PC2.
*   **IP-адреси:**
    *   Source IP: IP-адреса PC0 (не змінилась!).
    *   Destination IP: IP-адреса PC2 (не змінилась!).
*   **TTL:** Зменшено на 1 (напр., 127).

**Висновки:**
1.  **IP-адреси (Source/Destination) залишаються незмінними** протягом усього шляху від відправника до отримувача. Вони є глобальними ідентифікаторами.
2.  **MAC-адреси (Source/Destination) змінюються на кожному "стрибку"** (hop) між мережевими пристроями (від ПК до роутера, від роутера до наступного роутера і т.д.). Вони є локальними ідентифікаторами для доставки кадру в межах одного сегменту мережі.
3.  **TTL зменшується кожним маршрутизатором**, що обробляє пакет.

---

## Додаткове завдання (Опціонально)

### 1. Мережа з двома маршрутизаторами

**Завдання:** Переробити модель так, щоб кожну підмережу обслуговував окремий маршрутизатор, а самі маршрутизатори входили до однієї спільної підмережі.

**Пояснення:**
*   **Топологія:**
    *   PC-група 1 <-> Switch1 <-> Router1
    *   PC-група 2 <-> Switch2 <-> Router2
    *   Router1 <-> Switch_Transit <-> Router2 (або з'єднані напряму)
*   **Адресація (приклад):**
    *   Підмережа 1: `192.168.1.0/24` (обслуговує Router1)
    *   Підмережа 2: `192.168.2.0/24` (обслуговує Router2)
    *   Транзитна мережа (між роутерами): `10.0.0.0/24`
        *   Інтерфейс Router1 в транзитній мережі: `10.0.0.1`
        *   Інтерфейс Router2 в транзитній мережі: `10.0.0.2`
*   **Налаштування маршрутизації:**
    Тепер кожен роутер знає лише про свою локальну підмережу і про транзитну мережу. Щоб вони могли пересилати пакети далі, потрібні **статичні маршрути**:
    *   На **Router1** треба додати маршрут: "Щоб дістатися до мережі `192.168.2.0/24`, відправляй пакети на `10.0.0.2` (IP-адресу Router2)".
        *   Команда: `ip route 192.168.2.0 255.255.255.0 10.0.0.2`
    *   На **Router2** треба додати маршрут: "Щоб дістатися до мережі `192.168.1.0/24`, відправляй пакети на `10.0.0.1` (IP-адресу Router1)".
        *   Команда: `ip route 192.168.1.0 255.255.255.0 10.0.0.1`

### 2. Моделювання виходу в Інтернет

**Завдання:** Додати третій маршрутизатор, що імітує вихід в Інтернет до сервера 8.8.8.8.

**Пояснення:**
*   **Топологія:** До транзитної мережі (`10.0.0.0/24`) підключається третій маршрутизатор, **Router_INET**.
*   **Адресація:**
    *   Інтерфейс Router_INET в транзитній мережі: `10.0.0.3`
    *   Інший інтерфейс Router_INET (умовно, "зовнішній"): `8.8.8.1/24`
    *   До цієї "зовнішньої" мережі підключений сервер з IP `8.8.8.8`.
*   **Налаштування маршрутизації:**
    *   На **Router1** та **Router2** потрібно налаштувати **маршрут за замовчуванням**, який буде вести до "Інтернету": "Все, що ти не знаєш, куди відправити, відправляй на `10.0.0.3` (Router_INET)".
        *   Команда: `ip route 0.0.0.0 0.0.0.0 10.0.0.3`
    *   На **Router_INET** потрібно налаштувати зворотні маршрути, щоб він знав, як повернути відповідь до внутрішніх мереж:
        *   `ip route 192.168.1.0 255.255.255.0 10.0.0.1` (до мережі Router1)
        *   `ip route 192.168.2.0 255.255.255.0 10.0.0.2` (до мережі Router2)

Тепер, коли PC0 (192.168.1.10) спробує пінгувати 8.8.8.8, шлях пакета буде таким:
`PC0 -> R1 -> R2_INET -> Server`, а відповідь повернеться назад.
