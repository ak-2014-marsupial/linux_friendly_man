# Лабораторна робота: Робота з `systemd`

**Важливо:** Перед початком роботи переконайтеся, що у вас є права на читання, запис та виконання у директорії `/root`. Ви можете перевірити це за допомогою команди `sudo ls -ld /root`.

## 1. Створення `unit` файлу

Щоб створити `unit` файл `my.service`, який буде запускати скрипт при старті системи, необхідно створити файл `/etc/systemd/system/my.service` з наступним вмістом (для створення та редагування файлу потрібні права `sudo`):

```ini
[Unit]
Description=My service that writes the date to a log file

[Service]
ExecStart=/root/my.sh

[Install]
WantedBy=multi-user.target
```

**Пояснення:**

*   **`[Unit]`**: Ця секція містить загальну інформацію про `unit`.
    *   `Description`: Короткий опис сервісу.
*   **`[Service]`**: Ця секція описує, як керувати сервісом.
    *   `ExecStart`: Вказує повний шлях до команди або скрипту, який буде виконуватися при запуску сервісу.
*   **`[Install]`**: Ця секція містить інформацію про встановлення `unit`.
    *   `WantedBy`: Вказує, для якого `target` (рівня запуску) цей сервіс має бути увімкнений. `multi-user.target` відповідає за багатокористувацький режим роботи системи.

## 2. Створення файлу-сценарію

Далі, необхідно створити файл-сценарій `/root/my.sh`, який буде виконуватися сервісом (для створення та редагування файлу потрібні права `sudo`):

```bash
#!/bin/bash
while true; do
  date >> /var/log/my.log
  sleep 2
done
```

**Пояснення:**

*   `#!/bin/bash`: Вказує, що цей файл є `bash`-скриптом.
*   `while true; do ... done`: Це нескінченний цикл.
*   `date >> /var/log/my.log`: Ця команда додає поточну дату та час в кінець файлу `/var/log/my.log`.
*   `sleep 2`: Робить паузу на 2 секунди перед наступною ітерацією циклу.

Також, не забудьте зробити файл виконуваним:

```bash
sudo chmod +x /root/my.sh
```

## 3. Увімкнення та запуск сервісу

Після створення `unit` файлу та скрипту, необхідно виконати наступні команди:

1.  **Перезавантажити конфігурацію `systemd`**:
    ```bash
sudo systemctl daemon-reload
    ```
    Ця команда змушує `systemd` перечитати всі `unit` файли.

2.  **Увімкнути автоматичний запуск сервісу**:
    ```bash
sudo systemctl enable my.service
    ```
    Ця команда створює символічне посилання на `unit` файл у відповідній директорії `target`, щоб сервіс автоматично запускався при старті системи.

3.  **Запустити сервіс**:
    ```bash
sudo systemctl start my.service
    ```
    Ця команда негайно запускає сервіс.

4.  **Перевірити статус сервісу**:
    ```bash
sudo systemctl status my.service
    ```
    Ця команда покаже, чи запущений сервіс, а також останні записи з логів.

## 4. Вимкнення сервісу

Якщо ви більше не хочете, щоб сервіс запускався автоматично, виконайте наступні команди:

1.  **Зупинити сервіс**:
    ```bash
sudo systemctl stop my.service
    ```
    Ця команда негайно зупиняє сервіс.

2.  **Вимкнути автоматичний запуск**:
    ```bash
sudo systemctl disable my.service
    ```
    Ця команда видаляє символічне посилання, і сервіс більше не буде запускатися автоматично при старті системи.